# Chrome DevTools Protocol | Selenium

**URL:** https://www.selenium.dev/documentation/webdriver/bidi/cdp/_print
**Word Count:** 1185
**Links Count:** 118
**Scraped:** 2025-07-17 06:17:48
**Status:** completed

---

This is the multi-page printable view of this section. Click here to print.

[Return to the regular view of this page](https://www.selenium.dev/documentation/webdriver/bidi/cdp/).

# Chrome DevTools Protocol

Examples of working with Chrome DevTools Protocol in Selenium. CDP support is temporary until WebDriver BiDi has been implemented.

  * 1: Chrome DevTools Logging Features   * 2: Chrome DevTools Network Features   * 3: Chrome DevTools Script Features

Many browsers provide “DevTools” – a set of tools that are integrated with the browser that developers can use to debug web apps and explore the performance of their pages. Google Chrome’s DevTools make use of a protocol called the Chrome DevTools Protocol \(or “CDP” for short\). As the name suggests, this is not designed for testing, nor to have a stable API, so functionality is highly dependent on the version of the browser.

Selenium is working to implement a standards-based, cross-browser, stable alternative to CDP called \[WebDriver BiDi\]. Until the support for this new protocol has finished, Selenium plans to provide access to CDP features where applicable.

### Using Chrome DevTools Protocol with Selenium

Chrome and Edge have a method to send basic CDP commands. This does not work for features that require bidirectional communication, and you need to know what domains to enable when and the exact names and types of domains/methods/parameters.

  * Java   * Python   * CSharp   * Ruby   * JavaScript   * Kotlin

                  Map<String, Object> cookie = new HashMap<>();         cookie.put("name", "cheese");         cookie.put("value", "gouda");         cookie.put("domain", "www.selenium.dev");         cookie.put("secure", true);         ((HasCdp) driver).executeCdpCommand("Network.setCookie", cookie);

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/java/src/test/java/dev/selenium/bidi/cdp/CdpTest.java#L22-L27)

##### /examples/java/src/test/java/dev/selenium/bidi/cdp/CdpTest.java

Copy  Close               package dev.selenium.bidi.cdp;          import dev.selenium.BaseTest;     import org.junit.jupiter.api.Assertions;     import org.junit.jupiter.api.BeforeEach;     import org.junit.jupiter.api.Test;     import org.openqa.selenium.Cookie;     import org.openqa.selenium.chrome.ChromeDriver;     import org.openqa.selenium.chromium.HasCdp;          import java.util.HashMap;     import java.util.Map;          public class CdpTest extends BaseTest {       @BeforeEach       public void createSession() {         driver = new ChromeDriver();       }            @Test       public void setCookie() {         Map<String, Object> cookie = new HashMap<>();         cookie.put("name", "cheese");         cookie.put("value", "gouda");         cookie.put("domain", "www.selenium.dev");         cookie.put("secure", true);         ((HasCdp) driver).executeCdpCommand("Network.setCookie", cookie);              driver.get("https://www.selenium.dev");         Cookie cheese = driver.manage().getCookieNamed("cheese");         Assertions.assertEquals("gouda", cheese.getValue());       }     }                        cookie = {'name': 'cheese',                   'value': 'gouda',                   'domain': 'www.selenium.dev',                   'secure': True}              driver.execute_cdp_cmd('Network.setCookie', cookie)

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/python/tests/bidi/cdp/test_cdp.py#L2-L7)

##### /examples/python/tests/bidi/cdp/test\_cdp.py

Copy  Close               def test_set_cookie(driver):         cookie = {'name': 'cheese',                   'value': 'gouda',                   'domain': 'www.selenium.dev',                   'secure': True}              driver.execute_cdp_cmd('Network.setCookie', cookie)              driver.get('https://www.selenium.dev')         cheese = driver.get_cookie(cookie['name'])              assert cheese['value'] == 'gouda'                                var cookie = new Dictionary<string, object>                 {                     { "name", "cheese" },                     { "value", "gouda" },                     { "domain", "www.selenium.dev" },                     { "secure", true }                 };                 ((ChromeDriver)driver).ExecuteCdpCommand("Network.setCookie", cookie);

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/dotnet/SeleniumDocs/BiDi/CDP/CDPTest.cs#L14-L21)

##### /examples/dotnet/SeleniumDocs/BiDi/CDP/CDPTest.cs

Copy  Close               using System.Collections.Generic;     using Microsoft.VisualStudio.TestTools.UnitTesting;     using OpenQA.Selenium;     using OpenQA.Selenium.Chrome;          namespace SeleniumDocs.BiDi.CDP     {         [TestClass]         public class CDPTest : BaseChromeTest         {             [TestMethod]             public void SetCookie()             {                 var cookie = new Dictionary<string, object>                 {                     { "name", "cheese" },                     { "value", "gouda" },                     { "domain", "www.selenium.dev" },                     { "secure", true }                 };                 ((ChromeDriver)driver).ExecuteCdpCommand("Network.setCookie", cookie);                                  driver.Url = "https://www.selenium.dev";                 Cookie cheese = driver.Manage().Cookies.GetCookieNamed("cheese");                 Assert.AreEqual("gouda", cheese.Value);                  }         }     }                   driver.execute_cdp('Network.setCookie',                            name: 'cheese',                            value: 'gouda',                            domain: 'www.selenium.dev',                            secure: true)

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/ruby/spec/bidi/cdp/cdp_spec.rb#L9-L13)

##### /examples/ruby/spec/bidi/cdp/cdp\_spec.rb

Copy  Close               # frozen_string_literal: true          require 'spec_helper'          RSpec.describe 'Logging' do       let(:driver) { start_session }            it 'sets cookie' do         driver.execute_cdp('Network.setCookie',                            name: 'cheese',                            value: 'gouda',                            domain: 'www.selenium.dev',                            secure: true)              driver.get('https://www.selenium.dev')         cheese = driver.manage.cookie_named('cheese')              expect(cheese[:value]).to eq 'gouda'       end     end     

[Add Example](https://www.selenium.dev/documentation/about/contributing/#creating-examples)

[Add Example](https://www.selenium.dev/documentation/about/contributing/#creating-examples)

To make working with CDP easier, and to provide access to the more advanced features, Selenium bindings automatically generate classes and methods for the most common domains. CDP methods and implementations can change from version to version, though, so you want to keep the version of Chrome and the version of DevTools matching. Selenium supports the 3 most recent versions of Chrome at any given time, and tries to time releases to ensure that access to the latest versions are available.

This limitation provides additional challenges for several bindings, where dynamically generated CDP support requires users to regularly update their code to reference the proper version of CDP. In some cases an idealized implementation has been created that should work for any version of CDP without the user needing to change their code, but that is not always available.

Examples of how to use CDP in your Selenium tests can be found on the following pages, but we want to call out a couple commonly cited examples that are of limited practical value.

  * **Geo Location** — almost all sites use the IP address to determine physical location, so setting an emulated geolocation rarely has the desired effect.   * **Overriding Device Metrics** — Chrome provides a great API for setting [Mobile Emulation](https://chromedriver.chromium.org/mobile-emulation) in the Options classes, which is generally superior to attempting to do this with CDP.

# 1 - Chrome DevTools Logging Features

Logging features using CDP.

While Selenium 4 provides direct access to the Chrome DevTools Protocol, these methods will eventually be removed when WebDriver BiDi implemented.

## Console Logs

  * Java   * Python   * CSharp   * Ruby   * JavaScript   * Kotlin

                  ((HasLogEvents) driver).onLogEvent(consoleEvent(e -> messages.add(e.getMessages().get(0))));

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/java/src/test/java/dev/selenium/bidi/cdp/LoggingTest.java#L31)

##### /examples/java/src/test/java/dev/selenium/bidi/cdp/LoggingTest.java

Copy  Close               package dev.selenium.bidi.cdp;          import static org.openqa.selenium.devtools.events.CdpEventTypes.consoleEvent;          import dev.selenium.BaseTest;          import java.time.Duration;     import java.util.concurrent.CopyOnWriteArrayList;          import org.junit.jupiter.api.Assertions;     import org.junit.jupiter.api.BeforeEach;     import org.junit.jupiter.api.Test;     import org.openqa.selenium.*;     import org.openqa.selenium.chrome.ChromeDriver;     import org.openqa.selenium.logging.HasLogEvents;     import org.openqa.selenium.support.ui.WebDriverWait;          public class LoggingTest extends BaseTest {            @BeforeEach       public void createSession() {         driver = new ChromeDriver();         wait = new WebDriverWait(driver, Duration.ofSeconds(10));       }            @Test       public void consoleLogs() {         driver.get("https://www.selenium.dev/selenium/web/bidi/logEntryAdded.html");         CopyOnWriteArrayList<String> messages = new CopyOnWriteArrayList<>();              ((HasLogEvents) driver).onLogEvent(consoleEvent(e -> messages.add(e.getMessages().get(0))));              driver.findElement(By.id("consoleLog")).click();         driver.findElement(By.id("consoleError")).click();              wait.until(_d -> messages.size() > 1);         Assertions.assertTrue(messages.contains("Hello, world!"));         Assertions.assertTrue(messages.contains("I am console error"));       }     }                        async with driver.bidi_connection() as session:             async with Log(driver, session).add_listener(Console.ALL) as messages:

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/python/tests/bidi/cdp/test_logs.py#L11-12)

##### /examples/python/tests/bidi/cdp/test\_logs.py

Copy  Close               import pytest     from selenium.webdriver.common.bidi.console import Console     from selenium.webdriver.common.by import By     from selenium.webdriver.common.log import Log               @pytest.mark.trio     async def test_console_log(driver):         driver.get('https://www.selenium.dev/selenium/web/bidi/logEntryAdded.html')              async with driver.bidi_connection() as session:             async with Log(driver, session).add_listener(Console.ALL) as messages:                 driver.find_element(by=By.ID, value='consoleLog').click()                  assert messages["message"] == "Hello, world!"               @pytest.mark.trio     async def test_js_error(driver):         driver.get('https://www.selenium.dev/selenium/web/bidi/logEntryAdded.html')              async with driver.bidi_connection() as session:             async with Log(driver, session).add_js_error_listener() as messages:                 driver.find_element(by=By.ID, value='jsException').click()                  assert "Error: Not working" in messages.exception_details.exception.description                                using IJavaScriptEngine monitor = new JavaScriptEngine(driver);                 var messages = new List<string>();                 monitor.JavaScriptConsoleApiCalled += (_, e) =>                 {                     messages.Add(e.MessageContent);                 };                 await monitor.StartEventMonitoring();

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/dotnet/SeleniumDocs/BiDi/CDP/LoggingTest.cs#L19-L25)

##### /examples/dotnet/SeleniumDocs/BiDi/CDP/LoggingTest.cs

Copy  Close               using System;     using System.Collections.Generic;     using System.Threading.Tasks;     using Microsoft.IdentityModel.Tokens;     using Microsoft.VisualStudio.TestTools.UnitTesting;     using OpenQA.Selenium;     using OpenQA.Selenium.Support.UI;          namespace SeleniumDocs.BiDi.CDP     {         [TestClass]         public class LoggingTest : BaseChromeTest         {             [TestMethod]             public async Task ConsoleLogs()             {                 driver.Url = "https://www.selenium.dev/selenium/web/bidi/logEntryAdded.html";                      using IJavaScriptEngine monitor = new JavaScriptEngine(driver);                 var messages = new List<string>();                 monitor.JavaScriptConsoleApiCalled += (_, e) =>                 {                     messages.Add(e.MessageContent);                 };                 await monitor.StartEventMonitoring();                      driver.FindElement(By.Id("consoleLog")).Click();                 driver.FindElement(By.Id("consoleError")).Click();                 new WebDriverWait(driver, TimeSpan.FromSeconds(5)).Until(_ => messages.Count > 1);                 monitor.StopEventMonitoring();                      Assert.IsTrue(messages.Contains("Hello, world!"));                 Assert.IsTrue(messages.Contains("I am console error"));             }                          [TestMethod]             public async Task JsErrors()             {                 driver.Url = "https://www.selenium.dev/selenium/web/bidi/logEntryAdded.html";                      using IJavaScriptEngine monitor = new JavaScriptEngine(driver);                 var messages = new List<string>();                 monitor.JavaScriptExceptionThrown += (_, e) =>                 {                     messages.Add(e.Message);                 };                 await monitor.StartEventMonitoring();                      driver.FindElement(By.Id("jsException")).Click();                 new WebDriverWait(driver, TimeSpan.FromSeconds(5)).Until(_ => !messages.IsNullOrEmpty());                 monitor.StopEventMonitoring();                      Assert.IsTrue(messages.Contains("Uncaught"));             }         }     }                   driver.on_log_event(:console) { |log| logs << log.args.first }

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/ruby/spec/bidi/cdp/logging_spec.rb#L12)

##### /examples/ruby/spec/bidi/cdp/logging\_spec.rb

Copy  Close               # frozen_string_literal: true          require 'spec_helper'          RSpec.describe 'Logging' do       let(:driver) { start_session }            it 'listens for console logs' do         driver.get('https://www.selenium.dev/selenium/web/bidi/logEntryAdded.html')              logs = []         driver.on_log_event(:console) { |log| logs << log.args.first }              driver.find_element(id: 'consoleLog').click         driver.find_element(id: 'consoleError').click              Selenium::WebDriver::Wait.new.until { logs.size > 1 }         expect(logs).to include 'Hello, world!'         expect(logs).to include 'I am console error'       end            it 'listens for js exception' do         driver.get('https://www.selenium.dev/selenium/web/bidi/logEntryAdded.html')              exceptions = []         driver.on_log_event(:exception) { |exception| exceptions << exception }              driver.find_element(id: 'jsException').click              Selenium::WebDriver::Wait.new.until { exceptions.any? }         expect(exceptions.first&.description).to include 'Error: Not working'       end     end     

[Implementation Missing](https://github.com/SeleniumHQ/selenium)

[Add Example](https://www.selenium.dev/documentation/about/contributing/#creating-examples)

## JavaScript Exceptions

  * Java   * Python   * CSharp   * Ruby   * JavaScript   * Kotlin

[Implementation Missing](https://github.com/SeleniumHQ/selenium)                   async with driver.bidi_connection() as session:             async with Log(driver, session).add_js_error_listener() as messages:

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/python/tests/bidi/cdp/test_logs.py#L22-L23)

##### /examples/python/tests/bidi/cdp/test\_logs.py

Copy  Close               import pytest     from selenium.webdriver.common.bidi.console import Console     from selenium.webdriver.common.by import By     from selenium.webdriver.common.log import Log               @pytest.mark.trio     async def test_console_log(driver):         driver.get('https://www.selenium.dev/selenium/web/bidi/logEntryAdded.html')              async with driver.bidi_connection() as session:             async with Log(driver, session).add_listener(Console.ALL) as messages:                 driver.find_element(by=By.ID, value='consoleLog').click()                  assert messages["message"] == "Hello, world!"               @pytest.mark.trio     async def test_js_error(driver):         driver.get('https://www.selenium.dev/selenium/web/bidi/logEntryAdded.html')              async with driver.bidi_connection() as session:             async with Log(driver, session).add_js_error_listener() as messages:                 driver.find_element(by=By.ID, value='jsException').click()                  assert "Error: Not working" in messages.exception_details.exception.description                                using IJavaScriptEngine monitor = new JavaScriptEngine(driver);                 var messages = new List<string>();                 monitor.JavaScriptExceptionThrown += (_, e) =>                 {                     messages.Add(e.Message);                 };                 await monitor.StartEventMonitoring();

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/dotnet/SeleniumDocs/BiDi/CDP/LoggingTest.cs#L41-L47)

##### /examples/dotnet/SeleniumDocs/BiDi/CDP/LoggingTest.cs

Copy  Close               using System;     using System.Collections.Generic;     using System.Threading.Tasks;     using Microsoft.IdentityModel.Tokens;     using Microsoft.VisualStudio.TestTools.UnitTesting;     using OpenQA.Selenium;     using OpenQA.Selenium.Support.UI;          namespace SeleniumDocs.BiDi.CDP     {         [TestClass]         public class LoggingTest : BaseChromeTest         {             [TestMethod]             public async Task ConsoleLogs()             {                 driver.Url = "https://www.selenium.dev/selenium/web/bidi/logEntryAdded.html";                      using IJavaScriptEngine monitor = new JavaScriptEngine(driver);                 var messages = new List<string>();                 monitor.JavaScriptConsoleApiCalled += (_, e) =>                 {                     messages.Add(e.MessageContent);                 };                 await monitor.StartEventMonitoring();                      driver.FindElement(By.Id("consoleLog")).Click();                 driver.FindElement(By.Id("consoleError")).Click();                 new WebDriverWait(driver, TimeSpan.FromSeconds(5)).Until(_ => messages.Count > 1);                 monitor.StopEventMonitoring();                      Assert.IsTrue(messages.Contains("Hello, world!"));                 Assert.IsTrue(messages.Contains("I am console error"));             }                          [TestMethod]             public async Task JsErrors()             {                 driver.Url = "https://www.selenium.dev/selenium/web/bidi/logEntryAdded.html";                      using IJavaScriptEngine monitor = new JavaScriptEngine(driver);                 var messages = new List<string>();                 monitor.JavaScriptExceptionThrown += (_, e) =>                 {                     messages.Add(e.Message);                 };                 await monitor.StartEventMonitoring();                      driver.FindElement(By.Id("jsException")).Click();                 new WebDriverWait(driver, TimeSpan.FromSeconds(5)).Until(_ => !messages.IsNullOrEmpty());                 monitor.StopEventMonitoring();                      Assert.IsTrue(messages.Contains("Uncaught"));             }         }     }                   driver.on_log_event(:exception) { |exception| exceptions << exception }

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/ruby/spec/bidi/cdp/logging_spec.rb#L26)

##### /examples/ruby/spec/bidi/cdp/logging\_spec.rb

Copy  Close               # frozen_string_literal: true          require 'spec_helper'          RSpec.describe 'Logging' do       let(:driver) { start_session }            it 'listens for console logs' do         driver.get('https://www.selenium.dev/selenium/web/bidi/logEntryAdded.html')              logs = []         driver.on_log_event(:console) { |log| logs << log.args.first }              driver.find_element(id: 'consoleLog').click         driver.find_element(id: 'consoleError').click              Selenium::WebDriver::Wait.new.until { logs.size > 1 }         expect(logs).to include 'Hello, world!'         expect(logs).to include 'I am console error'       end            it 'listens for js exception' do         driver.get('https://www.selenium.dev/selenium/web/bidi/logEntryAdded.html')              exceptions = []         driver.on_log_event(:exception) { |exception| exceptions << exception }              driver.find_element(id: 'jsException').click              Selenium::WebDriver::Wait.new.until { exceptions.any? }         expect(exceptions.first&.description).to include 'Error: Not working'       end     end     

[Implementation Missing](https://github.com/SeleniumHQ/selenium)

[Add Example](https://www.selenium.dev/documentation/about/contributing/#creating-examples)

# 2 - Chrome DevTools Network Features

Network features using CDP.

While Selenium 4 provides direct access to the Chrome DevTools Protocol, these methods will eventually be removed when WebDriver BiDi implemented.

## Basic authentication

Some applications make use of browser authentication to secure pages. It used to be common to handle them in the URL, but browsers stopped supporting this. With this code you can insert the credentials into the header when necessary

  * Java   * Python   * CSharp   * Ruby   * JavaScript   * Kotlin

                  Predicate<URI> uriPredicate = uri -> uri.toString().contains("herokuapp.com");         Supplier<Credentials> authentication = UsernameAndPassword.of("admin", "admin");         ((HasAuthentication) driver).register(uriPredicate, authentication);

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/java/src/test/java/dev/selenium/bidi/cdp/NetworkTest.java#L41-L43)

##### /examples/java/src/test/java/dev/selenium/bidi/cdp/NetworkTest.java

Copy  Close               package dev.selenium.bidi.cdp;          import com.google.common.net.MediaType;     import dev.selenium.BaseTest;     import java.net.*;     import java.time.Duration;     import java.util.HashMap;     import java.util.List;     import java.util.Map;     import java.util.Objects;     import java.util.Optional;     import java.util.concurrent.CopyOnWriteArrayList;     import java.util.concurrent.atomic.AtomicBoolean;     import java.util.function.Predicate;     import java.util.function.Supplier;     import org.junit.jupiter.api.Assertions;     import org.junit.jupiter.api.BeforeEach;     import org.junit.jupiter.api.Test;     import org.openqa.selenium.*;     import org.openqa.selenium.chrome.ChromeDriver;     import org.openqa.selenium.devtools.DevTools;     import org.openqa.selenium.devtools.HasDevTools;     import org.openqa.selenium.devtools.NetworkInterceptor;     import org.openqa.selenium.devtools.v137.browser.Browser;     import org.openqa.selenium.devtools.v137.network.Network;     import org.openqa.selenium.devtools.v137.performance.Performance;     import org.openqa.selenium.devtools.v137.performance.model.Metric;     import org.openqa.selenium.remote.http.*;     import org.openqa.selenium.support.ui.WebDriverWait;          public class NetworkTest extends BaseTest {            @BeforeEach       public void createSession() {         driver = new ChromeDriver();         wait = new WebDriverWait(driver, Duration.ofSeconds(10));       }            @Test       public void basicAuthentication() {         Predicate<URI> uriPredicate = uri -> uri.toString().contains("herokuapp.com");         Supplier<Credentials> authentication = UsernameAndPassword.of("admin", "admin");         ((HasAuthentication) driver).register(uriPredicate, authentication);              driver.get("https://the-internet.herokuapp.com/basic_auth");              String successMessage = "Congratulations! You must have the proper credentials.";         WebElement elementMessage = driver.findElement(By.tagName("p"));         Assertions.assertEquals(successMessage, elementMessage.getText());       }            @Test       public void recordResponse() {         CopyOnWriteArrayList<String> contentType = new CopyOnWriteArrayList<>();              try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           HttpResponse res = next.execute(req);                           contentType.add(res.getHeader("Content-Type"));                           return res;                         })) {           driver.get("https://www.selenium.dev/selenium/web/blank.html");           wait.until(_d -> contentType.size() > 1);         }              Assertions.assertEquals("text/html; charset=utf-8", contentType.get(0));       }            @Test       public void transformResponses() {         try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 Route.matching(req -> true)                     .to(                         () ->                             req ->                                 new HttpResponse()                                     .setStatus(200)                                     .addHeader("Content-Type", MediaType.HTML_UTF_8.toString())                                     .setContent(Contents.utf8String("Creamy, delicious cheese!"))))) {           driver.get("https://www.selenium.dev/selenium/web/blank.html");         }              WebElement body = driver.findElement(By.tagName("body"));         Assertions.assertEquals("Creamy, delicious cheese!", body.getText());       }            @Test       public void interceptRequests() {         AtomicBoolean completed = new AtomicBoolean(false);              try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           if (req.getUri().contains("one.js")) {                             req =                                 new HttpRequest(                                     HttpMethod.GET, req.getUri().replace("one.js", "two.js"));                           }                           completed.set(true);                           return next.execute(req);                         })) {           driver.get("https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html");           driver.findElement(By.tagName("button")).click();         }              Assertions.assertEquals("two", driver.findElement(By.id("result")).getText());       }            @Test       public void performanceMetrics() {         driver.get("https://www.selenium.dev/selenium/web/frameset.html");              DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(Performance.enable(Optional.empty()));         List<Metric> metricList = devTools.send(Performance.getMetrics());              Map<String, Number> metrics = new HashMap<>();         for (Metric metric : metricList) {           metrics.put(metric.getName(), metric.getValue());         }              Assertions.assertTrue(metrics.get("DevToolsCommandDuration").doubleValue() > 0);         Assertions.assertEquals(12, metrics.get("Frames").intValue());       }            @Test       public void setCookie() {         DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(                 Network.setCookie(                         "cheese",                         "gouda",                         Optional.empty(),                         Optional.of("www.selenium.dev"),                         Optional.empty(),                         Optional.of(true),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty()));              driver.get("https://www.selenium.dev");         Cookie cheese = driver.manage().getCookieNamed("cheese");         Assertions.assertEquals("gouda", cheese.getValue());       }            @Test       public void waitForDownload() {         driver.get("https://www.selenium.dev/selenium/web/downloads/download.html");              DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(                 Browser.setDownloadBehavior(                         Browser.SetDownloadBehaviorBehavior.ALLOWANDNAME,                         Optional.empty(),                         Optional.of(""),                         Optional.of(true)));              AtomicBoolean completed = new AtomicBoolean(false);         devTools.addListener(                 Browser.downloadProgress(),                 e -> completed.set(Objects.equals(e.getState().toString(), "completed")));              driver.findElement(By.id("file-2")).click();              Assertions.assertDoesNotThrow(() -> wait.until(_d -> completed));       }     }                            credentials = base64.b64encode("admin:admin".encode()).decode()             auth = {'authorization': 'Basic ' + credentials}             await connection.session.execute(connection.devtools.network.set_extra_http_headers(Headers(auth)))

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/python/tests/bidi/cdp/test_network.py#L13-15)

##### /examples/python/tests/bidi/cdp/test\_network.py

Copy  Close               import base64          import pytest     from selenium.webdriver.common.by import By     from selenium.webdriver.common.devtools.v137.network import Headers               @pytest.mark.trio     async def test_basic_auth(driver):         async with driver.bidi_connection() as connection:             await connection.session.execute(connection.devtools.network.enable())                  credentials = base64.b64encode("admin:admin".encode()).decode()             auth = {'authorization': 'Basic ' + credentials}             await connection.session.execute(connection.devtools.network.set_extra_http_headers(Headers(auth)))                  driver.get('https://the-internet.herokuapp.com/basic_auth')              success = driver.find_element(by=By.TAG_NAME, value='p')         assert success.text == 'Congratulations! You must have the proper credentials.'          @pytest.mark.trio     async def test_performance(driver):         driver.get('https://www.selenium.dev/selenium/web/frameset.html')              async with driver.bidi_connection() as connection:             await connection.session.execute(connection.devtools.performance.enable())             metric_list = await connection.session.execute(connection.devtools.performance.get_metrics())              metrics = {metric.name: metric.value for metric in metric_list}              assert metrics["DevToolsCommandDuration"] > 0         assert metrics["Frames"] == 12          @pytest.mark.trio     async def test_set_cookie(driver):         async with driver.bidi_connection() as connection:             execution = connection.devtools.network.set_cookie(                 name="cheese",                 value="gouda",                 domain="www.selenium.dev",                 secure=True             )             await connection.session.execute(execution)              driver.get("https://www.selenium.dev")         cheese = driver.get_cookie("cheese")              assert cheese["value"] == "gouda"                                var handler = new NetworkAuthenticationHandler()                 {                     UriMatcher = uri => uri.AbsoluteUri.Contains("herokuapp"),                     Credentials = new PasswordCredentials("admin", "admin")                 };                 var networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddAuthenticationHandler(handler);                 await networkInterceptor.StartMonitoring();

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/dotnet/SeleniumDocs/BiDi/CDP/NetworkTest.cs#L25-L32)

##### /examples/dotnet/SeleniumDocs/BiDi/CDP/NetworkTest.cs

Copy  Close               using System.Collections.Generic;     using System.Threading.Tasks;     using Microsoft.VisualStudio.TestTools.UnitTesting;     using OpenQA.Selenium;     using OpenQA.Selenium.DevTools;     using System.Linq;     using OpenQA.Selenium.DevTools.V137.Network;     using OpenQA.Selenium.DevTools.V137.Performance;               namespace SeleniumDocs.BiDi.CDP     {         [TestClass]         public class NetworkTest : BaseTest         {             [TestInitialize]             public void Startup()             {                 StartDriver("137");             }                  [TestMethod]             public async Task BasicAuthentication()             {                 var handler = new NetworkAuthenticationHandler()                 {                     UriMatcher = uri => uri.AbsoluteUri.Contains("herokuapp"),                     Credentials = new PasswordCredentials("admin", "admin")                 };                 var networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddAuthenticationHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://the-internet.herokuapp.com/basic_auth");                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("Congratulations! You must have the proper credentials.",                     driver.FindElement(By.TagName("p")).Text);             }                  [TestMethod]             public async Task RecordNetworkResponse()             {                 var contentType = new List<string>();                      INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.NetworkResponseReceived += (_, e)  =>                 {                     contentType.Add(e.ResponseHeaders["content-type"]);                 };                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://www.selenium.dev/selenium/web/blank.html");                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("text/html; charset=utf-8", contentType[0]);             }                  [TestMethod]             public async Task TransformNetworkResponse()             {                 var handler = new NetworkResponseHandler()                 {                     ResponseMatcher = _ => true,                     ResponseTransformer = _ => new HttpResponseData                     {                         StatusCode = 200,                         Body = "Creamy, delicious cheese!"                     }                 };                 INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddResponseHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://www.selenium.dev");                 await networkInterceptor.StopMonitoring();                      var body = driver.FindElement(By.TagName("body"));                 Assert.AreEqual("Creamy, delicious cheese!", body.Text);             }                  [TestMethod]             public async Task TransformNetworkRequest()             {                 var handler = new NetworkRequestHandler                 {                     RequestMatcher = request => request.Url.Contains("one.js"),                     RequestTransformer = request =>                     {                         request.Url = request.Url.Replace("one", "two");                              return request;                     }                 };                 INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddRequestHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Url = "https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html";                 driver.FindElement(By.TagName("button")).Click();                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("two", driver.FindElement(By.Id("result")).Text);             }                  [TestMethod]             public async Task PerformanceMetrics()             {                 driver.Url = "https://www.selenium.dev/selenium/web/frameset.html";                      var session = ((IDevTools)driver).GetDevToolsSession();                 var domains = session.GetVersionSpecificDomains<OpenQA.Selenium.DevTools.V137.DevToolsSessionDomains>();                      await domains.Performance.Enable(new OpenQA.Selenium.DevTools.V137.Performance.EnableCommandSettings());                 var metricsResponse =                     await session.SendCommand<GetMetricsCommandSettings, GetMetricsCommandResponse>(                         new GetMetricsCommandSettings()                     );                      var metrics = metricsResponse.Metrics.ToDictionary(                     dict => dict.Name,                     dict => dict.Value                 );                      Assert.IsTrue(metrics["DevToolsCommandDuration"] > 0);                 Assert.AreEqual(12, metrics["Frames"]);             }                  [TestMethod]             public async Task SetCookie()             {                 var session = ((IDevTools)driver).GetDevToolsSession();                 var domains = session.GetVersionSpecificDomains<OpenQA.Selenium.DevTools.V137.DevToolsSessionDomains>();                 await domains.Network.Enable(new OpenQA.Selenium.DevTools.V137.Network.EnableCommandSettings());                      var cookieCommandSettings = new SetCookieCommandSettings                 {                     Name = "cheese",                     Value = "gouda",                     Domain = "www.selenium.dev",                     Secure = true                 };                 await domains.Network.SetCookie(cookieCommandSettings);                      driver.Url = "https://www.selenium.dev";                 OpenQA.Selenium.Cookie cheese = driver.Manage().Cookies.GetCookieNamed("cheese");                 Assert.AreEqual("gouda", cheese.Value);             }              }     }                        driver.register(username: 'admin',                         password: 'admin',                         uri: /herokuapp/)

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/ruby/spec/bidi/cdp/network_spec.rb#L9-L11)

##### /examples/ruby/spec/bidi/cdp/network\_spec.rb

Copy  Close               # frozen_string_literal: true          require 'spec_helper'          RSpec.describe 'Network' do       let(:driver) { start_session }            it 'does basic authentication' do         driver.register(username: 'admin',                         password: 'admin',                         uri: /herokuapp/)              driver.get('https://the-internet.herokuapp.com/basic_auth')              expect(driver.find_element(tag_name: 'p').text).to eq('Congratulations! You must have the proper credentials.')       end            it 'records network response' do         content_type = []         driver.intercept do |request, &continue|           continue.call(request) do |response|             content_type << response.headers['content-type']           end         end              driver.get('https://www.selenium.dev/selenium/web/blank.html')         expect(content_type.first).to eq('text/html; charset=utf-8')       end            it 'transforms network response' do         driver.intercept do |request, &continue|           continue.call(request) do |response|             response.body = 'Creamy, delicious cheese!' if request.url.include?('blank')           end         end              driver.get('https://www.selenium.dev/selenium/web/blank.html')         expect(driver.find_element(tag_name: 'body').text).to eq('Creamy, delicious cheese!')       end            it 'intercepts network request' do         driver.intercept do |request, &continue|           uri = URI(request.url)           request.url = uri.to_s.gsub('one', 'two') if uri.path&.end_with?('one.js')           continue.call(request)         end              driver.get('https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html')         driver.find_element(tag_name: 'button').click         expect(driver.find_element(id: 'result').text).to eq('two')       end            it 'gets performance metrics' do         driver.get('https://www.selenium.dev/selenium/web/frameset.html')              driver.devtools.performance.enable         metric_list = driver.devtools.performance.get_metrics.dig('result', 'metrics')              metrics = metric_list.each_with_object({}) do |metric, hash|           hash[metric['name']] = metric['value']         end              expect(metrics['DevToolsCommandDuration']).to be > 0         expect(metrics['Frames']).to eq 12       end            it 'sets cookie' do         driver.devtools.network.set_cookie(name: 'cheese',                                            value: 'gouda',                                            domain: 'www.selenium.dev',                                            secure: true)              driver.get('https://www.selenium.dev')         cheese = driver.manage.cookie_named('cheese')              expect(cheese[:value]).to eq 'gouda'       end            it 'waits for downloads', except: {platform: :windows} do         driver.get('https://www.selenium.dev/selenium/web/downloads/download.html')              driver.devtools.browser.set_download_behavior(behavior: 'allow',                                                       download_path: '',                                                       events_enabled: true)              driver.devtools.browser.on(:download_progress) do |progress|           @completed = progress['state'] == 'completed'         end              driver.find_element(id: 'file-2').click              expect { Selenium::WebDriver::Wait.new.until { @completed } }.not_to raise_exception       end     end     

[Implementation Missing](https://github.com/SeleniumHQ/selenium)

[Implementation Missing](https://github.com/SeleniumHQ/selenium)

## Network Interception

Both requests and responses can be recorded or transformed.

#### Response information

  * Java   * Python   * CSharp   * Ruby   * JavaScript   * Kotlin

                  try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           HttpResponse res = next.execute(req);                           contentType.add(res.getHeader("Content-Type"));                           return res;                         })) {

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/java/src/test/java/dev/selenium/bidi/cdp/NetworkTest.java#L56-L65)

##### /examples/java/src/test/java/dev/selenium/bidi/cdp/NetworkTest.java

Copy  Close               package dev.selenium.bidi.cdp;          import com.google.common.net.MediaType;     import dev.selenium.BaseTest;     import java.net.*;     import java.time.Duration;     import java.util.HashMap;     import java.util.List;     import java.util.Map;     import java.util.Objects;     import java.util.Optional;     import java.util.concurrent.CopyOnWriteArrayList;     import java.util.concurrent.atomic.AtomicBoolean;     import java.util.function.Predicate;     import java.util.function.Supplier;     import org.junit.jupiter.api.Assertions;     import org.junit.jupiter.api.BeforeEach;     import org.junit.jupiter.api.Test;     import org.openqa.selenium.*;     import org.openqa.selenium.chrome.ChromeDriver;     import org.openqa.selenium.devtools.DevTools;     import org.openqa.selenium.devtools.HasDevTools;     import org.openqa.selenium.devtools.NetworkInterceptor;     import org.openqa.selenium.devtools.v137.browser.Browser;     import org.openqa.selenium.devtools.v137.network.Network;     import org.openqa.selenium.devtools.v137.performance.Performance;     import org.openqa.selenium.devtools.v137.performance.model.Metric;     import org.openqa.selenium.remote.http.*;     import org.openqa.selenium.support.ui.WebDriverWait;          public class NetworkTest extends BaseTest {            @BeforeEach       public void createSession() {         driver = new ChromeDriver();         wait = new WebDriverWait(driver, Duration.ofSeconds(10));       }            @Test       public void basicAuthentication() {         Predicate<URI> uriPredicate = uri -> uri.toString().contains("herokuapp.com");         Supplier<Credentials> authentication = UsernameAndPassword.of("admin", "admin");         ((HasAuthentication) driver).register(uriPredicate, authentication);              driver.get("https://the-internet.herokuapp.com/basic_auth");              String successMessage = "Congratulations! You must have the proper credentials.";         WebElement elementMessage = driver.findElement(By.tagName("p"));         Assertions.assertEquals(successMessage, elementMessage.getText());       }            @Test       public void recordResponse() {         CopyOnWriteArrayList<String> contentType = new CopyOnWriteArrayList<>();              try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           HttpResponse res = next.execute(req);                           contentType.add(res.getHeader("Content-Type"));                           return res;                         })) {           driver.get("https://www.selenium.dev/selenium/web/blank.html");           wait.until(_d -> contentType.size() > 1);         }              Assertions.assertEquals("text/html; charset=utf-8", contentType.get(0));       }            @Test       public void transformResponses() {         try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 Route.matching(req -> true)                     .to(                         () ->                             req ->                                 new HttpResponse()                                     .setStatus(200)                                     .addHeader("Content-Type", MediaType.HTML_UTF_8.toString())                                     .setContent(Contents.utf8String("Creamy, delicious cheese!"))))) {           driver.get("https://www.selenium.dev/selenium/web/blank.html");         }              WebElement body = driver.findElement(By.tagName("body"));         Assertions.assertEquals("Creamy, delicious cheese!", body.getText());       }            @Test       public void interceptRequests() {         AtomicBoolean completed = new AtomicBoolean(false);              try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           if (req.getUri().contains("one.js")) {                             req =                                 new HttpRequest(                                     HttpMethod.GET, req.getUri().replace("one.js", "two.js"));                           }                           completed.set(true);                           return next.execute(req);                         })) {           driver.get("https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html");           driver.findElement(By.tagName("button")).click();         }              Assertions.assertEquals("two", driver.findElement(By.id("result")).getText());       }            @Test       public void performanceMetrics() {         driver.get("https://www.selenium.dev/selenium/web/frameset.html");              DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(Performance.enable(Optional.empty()));         List<Metric> metricList = devTools.send(Performance.getMetrics());              Map<String, Number> metrics = new HashMap<>();         for (Metric metric : metricList) {           metrics.put(metric.getName(), metric.getValue());         }              Assertions.assertTrue(metrics.get("DevToolsCommandDuration").doubleValue() > 0);         Assertions.assertEquals(12, metrics.get("Frames").intValue());       }            @Test       public void setCookie() {         DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(                 Network.setCookie(                         "cheese",                         "gouda",                         Optional.empty(),                         Optional.of("www.selenium.dev"),                         Optional.empty(),                         Optional.of(true),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty()));              driver.get("https://www.selenium.dev");         Cookie cheese = driver.manage().getCookieNamed("cheese");         Assertions.assertEquals("gouda", cheese.getValue());       }            @Test       public void waitForDownload() {         driver.get("https://www.selenium.dev/selenium/web/downloads/download.html");              DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(                 Browser.setDownloadBehavior(                         Browser.SetDownloadBehaviorBehavior.ALLOWANDNAME,                         Optional.empty(),                         Optional.of(""),                         Optional.of(true)));              AtomicBoolean completed = new AtomicBoolean(false);         devTools.addListener(                 Browser.downloadProgress(),                 e -> completed.set(Objects.equals(e.getState().toString(), "completed")));              driver.findElement(By.id("file-2")).click();              Assertions.assertDoesNotThrow(() -> wait.until(_d -> completed));       }     }     

[Implementation Missing](https://github.com/SeleniumHQ/selenium)                           INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.NetworkResponseReceived += (_, e)  =>                 {                     contentType.Add(e.ResponseHeaders["content-type"]);                 };                 await networkInterceptor.StartMonitoring();

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/dotnet/SeleniumDocs/BiDi/CDP/NetworkTest.cs#L46-L51)

##### /examples/dotnet/SeleniumDocs/BiDi/CDP/NetworkTest.cs

Copy  Close               using System.Collections.Generic;     using System.Threading.Tasks;     using Microsoft.VisualStudio.TestTools.UnitTesting;     using OpenQA.Selenium;     using OpenQA.Selenium.DevTools;     using System.Linq;     using OpenQA.Selenium.DevTools.V137.Network;     using OpenQA.Selenium.DevTools.V137.Performance;               namespace SeleniumDocs.BiDi.CDP     {         [TestClass]         public class NetworkTest : BaseTest         {             [TestInitialize]             public void Startup()             {                 StartDriver("137");             }                  [TestMethod]             public async Task BasicAuthentication()             {                 var handler = new NetworkAuthenticationHandler()                 {                     UriMatcher = uri => uri.AbsoluteUri.Contains("herokuapp"),                     Credentials = new PasswordCredentials("admin", "admin")                 };                 var networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddAuthenticationHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://the-internet.herokuapp.com/basic_auth");                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("Congratulations! You must have the proper credentials.",                     driver.FindElement(By.TagName("p")).Text);             }                  [TestMethod]             public async Task RecordNetworkResponse()             {                 var contentType = new List<string>();                      INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.NetworkResponseReceived += (_, e)  =>                 {                     contentType.Add(e.ResponseHeaders["content-type"]);                 };                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://www.selenium.dev/selenium/web/blank.html");                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("text/html; charset=utf-8", contentType[0]);             }                  [TestMethod]             public async Task TransformNetworkResponse()             {                 var handler = new NetworkResponseHandler()                 {                     ResponseMatcher = _ => true,                     ResponseTransformer = _ => new HttpResponseData                     {                         StatusCode = 200,                         Body = "Creamy, delicious cheese!"                     }                 };                 INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddResponseHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://www.selenium.dev");                 await networkInterceptor.StopMonitoring();                      var body = driver.FindElement(By.TagName("body"));                 Assert.AreEqual("Creamy, delicious cheese!", body.Text);             }                  [TestMethod]             public async Task TransformNetworkRequest()             {                 var handler = new NetworkRequestHandler                 {                     RequestMatcher = request => request.Url.Contains("one.js"),                     RequestTransformer = request =>                     {                         request.Url = request.Url.Replace("one", "two");                              return request;                     }                 };                 INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddRequestHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Url = "https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html";                 driver.FindElement(By.TagName("button")).Click();                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("two", driver.FindElement(By.Id("result")).Text);             }                  [TestMethod]             public async Task PerformanceMetrics()             {                 driver.Url = "https://www.selenium.dev/selenium/web/frameset.html";                      var session = ((IDevTools)driver).GetDevToolsSession();                 var domains = session.GetVersionSpecificDomains<OpenQA.Selenium.DevTools.V137.DevToolsSessionDomains>();                      await domains.Performance.Enable(new OpenQA.Selenium.DevTools.V137.Performance.EnableCommandSettings());                 var metricsResponse =                     await session.SendCommand<GetMetricsCommandSettings, GetMetricsCommandResponse>(                         new GetMetricsCommandSettings()                     );                      var metrics = metricsResponse.Metrics.ToDictionary(                     dict => dict.Name,                     dict => dict.Value                 );                      Assert.IsTrue(metrics["DevToolsCommandDuration"] > 0);                 Assert.AreEqual(12, metrics["Frames"]);             }                  [TestMethod]             public async Task SetCookie()             {                 var session = ((IDevTools)driver).GetDevToolsSession();                 var domains = session.GetVersionSpecificDomains<OpenQA.Selenium.DevTools.V137.DevToolsSessionDomains>();                 await domains.Network.Enable(new OpenQA.Selenium.DevTools.V137.Network.EnableCommandSettings());                      var cookieCommandSettings = new SetCookieCommandSettings                 {                     Name = "cheese",                     Value = "gouda",                     Domain = "www.selenium.dev",                     Secure = true                 };                 await domains.Network.SetCookie(cookieCommandSettings);                      driver.Url = "https://www.selenium.dev";                 OpenQA.Selenium.Cookie cheese = driver.Manage().Cookies.GetCookieNamed("cheese");                 Assert.AreEqual("gouda", cheese.Value);             }              }     }                        driver.intercept do |request, &continue|           continue.call(request) do |response|             content_type << response.headers['content-type']           end         end

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/ruby/spec/bidi/cdp/network_spec.rb#L20-L24)

##### /examples/ruby/spec/bidi/cdp/network\_spec.rb

Copy  Close               # frozen_string_literal: true          require 'spec_helper'          RSpec.describe 'Network' do       let(:driver) { start_session }            it 'does basic authentication' do         driver.register(username: 'admin',                         password: 'admin',                         uri: /herokuapp/)              driver.get('https://the-internet.herokuapp.com/basic_auth')              expect(driver.find_element(tag_name: 'p').text).to eq('Congratulations! You must have the proper credentials.')       end            it 'records network response' do         content_type = []         driver.intercept do |request, &continue|           continue.call(request) do |response|             content_type << response.headers['content-type']           end         end              driver.get('https://www.selenium.dev/selenium/web/blank.html')         expect(content_type.first).to eq('text/html; charset=utf-8')       end            it 'transforms network response' do         driver.intercept do |request, &continue|           continue.call(request) do |response|             response.body = 'Creamy, delicious cheese!' if request.url.include?('blank')           end         end              driver.get('https://www.selenium.dev/selenium/web/blank.html')         expect(driver.find_element(tag_name: 'body').text).to eq('Creamy, delicious cheese!')       end            it 'intercepts network request' do         driver.intercept do |request, &continue|           uri = URI(request.url)           request.url = uri.to_s.gsub('one', 'two') if uri.path&.end_with?('one.js')           continue.call(request)         end              driver.get('https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html')         driver.find_element(tag_name: 'button').click         expect(driver.find_element(id: 'result').text).to eq('two')       end            it 'gets performance metrics' do         driver.get('https://www.selenium.dev/selenium/web/frameset.html')              driver.devtools.performance.enable         metric_list = driver.devtools.performance.get_metrics.dig('result', 'metrics')              metrics = metric_list.each_with_object({}) do |metric, hash|           hash[metric['name']] = metric['value']         end              expect(metrics['DevToolsCommandDuration']).to be > 0         expect(metrics['Frames']).to eq 12       end            it 'sets cookie' do         driver.devtools.network.set_cookie(name: 'cheese',                                            value: 'gouda',                                            domain: 'www.selenium.dev',                                            secure: true)              driver.get('https://www.selenium.dev')         cheese = driver.manage.cookie_named('cheese')              expect(cheese[:value]).to eq 'gouda'       end            it 'waits for downloads', except: {platform: :windows} do         driver.get('https://www.selenium.dev/selenium/web/downloads/download.html')              driver.devtools.browser.set_download_behavior(behavior: 'allow',                                                       download_path: '',                                                       events_enabled: true)              driver.devtools.browser.on(:download_progress) do |progress|           @completed = progress['state'] == 'completed'         end              driver.find_element(id: 'file-2').click              expect { Selenium::WebDriver::Wait.new.until { @completed } }.not_to raise_exception       end     end     

[Implementation Missing](https://github.com/SeleniumHQ/selenium)

[Add Example](https://www.selenium.dev/documentation/about/contributing/#creating-examples)

#### Response transformation

  * Java   * Python   * CSharp   * Ruby   * JavaScript   * Kotlin

                  try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 Route.matching(req -> true)                     .to(                         () ->                             req ->                                 new HttpResponse()                                     .setStatus(200)                                     .addHeader("Content-Type", MediaType.HTML_UTF_8.toString())                                     .setContent(Contents.utf8String("Creamy, delicious cheese!"))))) {

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/java/src/test/java/dev/selenium/bidi/cdp/NetworkTest.java#L75-L85)

##### /examples/java/src/test/java/dev/selenium/bidi/cdp/NetworkTest.java

Copy  Close               package dev.selenium.bidi.cdp;          import com.google.common.net.MediaType;     import dev.selenium.BaseTest;     import java.net.*;     import java.time.Duration;     import java.util.HashMap;     import java.util.List;     import java.util.Map;     import java.util.Objects;     import java.util.Optional;     import java.util.concurrent.CopyOnWriteArrayList;     import java.util.concurrent.atomic.AtomicBoolean;     import java.util.function.Predicate;     import java.util.function.Supplier;     import org.junit.jupiter.api.Assertions;     import org.junit.jupiter.api.BeforeEach;     import org.junit.jupiter.api.Test;     import org.openqa.selenium.*;     import org.openqa.selenium.chrome.ChromeDriver;     import org.openqa.selenium.devtools.DevTools;     import org.openqa.selenium.devtools.HasDevTools;     import org.openqa.selenium.devtools.NetworkInterceptor;     import org.openqa.selenium.devtools.v137.browser.Browser;     import org.openqa.selenium.devtools.v137.network.Network;     import org.openqa.selenium.devtools.v137.performance.Performance;     import org.openqa.selenium.devtools.v137.performance.model.Metric;     import org.openqa.selenium.remote.http.*;     import org.openqa.selenium.support.ui.WebDriverWait;          public class NetworkTest extends BaseTest {            @BeforeEach       public void createSession() {         driver = new ChromeDriver();         wait = new WebDriverWait(driver, Duration.ofSeconds(10));       }            @Test       public void basicAuthentication() {         Predicate<URI> uriPredicate = uri -> uri.toString().contains("herokuapp.com");         Supplier<Credentials> authentication = UsernameAndPassword.of("admin", "admin");         ((HasAuthentication) driver).register(uriPredicate, authentication);              driver.get("https://the-internet.herokuapp.com/basic_auth");              String successMessage = "Congratulations! You must have the proper credentials.";         WebElement elementMessage = driver.findElement(By.tagName("p"));         Assertions.assertEquals(successMessage, elementMessage.getText());       }            @Test       public void recordResponse() {         CopyOnWriteArrayList<String> contentType = new CopyOnWriteArrayList<>();              try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           HttpResponse res = next.execute(req);                           contentType.add(res.getHeader("Content-Type"));                           return res;                         })) {           driver.get("https://www.selenium.dev/selenium/web/blank.html");           wait.until(_d -> contentType.size() > 1);         }              Assertions.assertEquals("text/html; charset=utf-8", contentType.get(0));       }            @Test       public void transformResponses() {         try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 Route.matching(req -> true)                     .to(                         () ->                             req ->                                 new HttpResponse()                                     .setStatus(200)                                     .addHeader("Content-Type", MediaType.HTML_UTF_8.toString())                                     .setContent(Contents.utf8String("Creamy, delicious cheese!"))))) {           driver.get("https://www.selenium.dev/selenium/web/blank.html");         }              WebElement body = driver.findElement(By.tagName("body"));         Assertions.assertEquals("Creamy, delicious cheese!", body.getText());       }            @Test       public void interceptRequests() {         AtomicBoolean completed = new AtomicBoolean(false);              try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           if (req.getUri().contains("one.js")) {                             req =                                 new HttpRequest(                                     HttpMethod.GET, req.getUri().replace("one.js", "two.js"));                           }                           completed.set(true);                           return next.execute(req);                         })) {           driver.get("https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html");           driver.findElement(By.tagName("button")).click();         }              Assertions.assertEquals("two", driver.findElement(By.id("result")).getText());       }            @Test       public void performanceMetrics() {         driver.get("https://www.selenium.dev/selenium/web/frameset.html");              DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(Performance.enable(Optional.empty()));         List<Metric> metricList = devTools.send(Performance.getMetrics());              Map<String, Number> metrics = new HashMap<>();         for (Metric metric : metricList) {           metrics.put(metric.getName(), metric.getValue());         }              Assertions.assertTrue(metrics.get("DevToolsCommandDuration").doubleValue() > 0);         Assertions.assertEquals(12, metrics.get("Frames").intValue());       }            @Test       public void setCookie() {         DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(                 Network.setCookie(                         "cheese",                         "gouda",                         Optional.empty(),                         Optional.of("www.selenium.dev"),                         Optional.empty(),                         Optional.of(true),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty()));              driver.get("https://www.selenium.dev");         Cookie cheese = driver.manage().getCookieNamed("cheese");         Assertions.assertEquals("gouda", cheese.getValue());       }            @Test       public void waitForDownload() {         driver.get("https://www.selenium.dev/selenium/web/downloads/download.html");              DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(                 Browser.setDownloadBehavior(                         Browser.SetDownloadBehaviorBehavior.ALLOWANDNAME,                         Optional.empty(),                         Optional.of(""),                         Optional.of(true)));              AtomicBoolean completed = new AtomicBoolean(false);         devTools.addListener(                 Browser.downloadProgress(),                 e -> completed.set(Objects.equals(e.getState().toString(), "completed")));              driver.findElement(By.id("file-2")).click();              Assertions.assertDoesNotThrow(() -> wait.until(_d -> completed));       }     }     

[Implementation Missing](https://github.com/SeleniumHQ/selenium)                           var handler = new NetworkResponseHandler()                 {                     ResponseMatcher = _ => true,                     ResponseTransformer = _ => new HttpResponseData                     {                         StatusCode = 200,                         Body = "Creamy, delicious cheese!"                     }                 };                 INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddResponseHandler(handler);                 await networkInterceptor.StartMonitoring();

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/dotnet/SeleniumDocs/BiDi/CDP/NetworkTest.cs#L62-L73)

##### /examples/dotnet/SeleniumDocs/BiDi/CDP/NetworkTest.cs

Copy  Close               using System.Collections.Generic;     using System.Threading.Tasks;     using Microsoft.VisualStudio.TestTools.UnitTesting;     using OpenQA.Selenium;     using OpenQA.Selenium.DevTools;     using System.Linq;     using OpenQA.Selenium.DevTools.V137.Network;     using OpenQA.Selenium.DevTools.V137.Performance;               namespace SeleniumDocs.BiDi.CDP     {         [TestClass]         public class NetworkTest : BaseTest         {             [TestInitialize]             public void Startup()             {                 StartDriver("137");             }                  [TestMethod]             public async Task BasicAuthentication()             {                 var handler = new NetworkAuthenticationHandler()                 {                     UriMatcher = uri => uri.AbsoluteUri.Contains("herokuapp"),                     Credentials = new PasswordCredentials("admin", "admin")                 };                 var networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddAuthenticationHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://the-internet.herokuapp.com/basic_auth");                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("Congratulations! You must have the proper credentials.",                     driver.FindElement(By.TagName("p")).Text);             }                  [TestMethod]             public async Task RecordNetworkResponse()             {                 var contentType = new List<string>();                      INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.NetworkResponseReceived += (_, e)  =>                 {                     contentType.Add(e.ResponseHeaders["content-type"]);                 };                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://www.selenium.dev/selenium/web/blank.html");                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("text/html; charset=utf-8", contentType[0]);             }                  [TestMethod]             public async Task TransformNetworkResponse()             {                 var handler = new NetworkResponseHandler()                 {                     ResponseMatcher = _ => true,                     ResponseTransformer = _ => new HttpResponseData                     {                         StatusCode = 200,                         Body = "Creamy, delicious cheese!"                     }                 };                 INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddResponseHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://www.selenium.dev");                 await networkInterceptor.StopMonitoring();                      var body = driver.FindElement(By.TagName("body"));                 Assert.AreEqual("Creamy, delicious cheese!", body.Text);             }                  [TestMethod]             public async Task TransformNetworkRequest()             {                 var handler = new NetworkRequestHandler                 {                     RequestMatcher = request => request.Url.Contains("one.js"),                     RequestTransformer = request =>                     {                         request.Url = request.Url.Replace("one", "two");                              return request;                     }                 };                 INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddRequestHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Url = "https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html";                 driver.FindElement(By.TagName("button")).Click();                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("two", driver.FindElement(By.Id("result")).Text);             }                  [TestMethod]             public async Task PerformanceMetrics()             {                 driver.Url = "https://www.selenium.dev/selenium/web/frameset.html";                      var session = ((IDevTools)driver).GetDevToolsSession();                 var domains = session.GetVersionSpecificDomains<OpenQA.Selenium.DevTools.V137.DevToolsSessionDomains>();                      await domains.Performance.Enable(new OpenQA.Selenium.DevTools.V137.Performance.EnableCommandSettings());                 var metricsResponse =                     await session.SendCommand<GetMetricsCommandSettings, GetMetricsCommandResponse>(                         new GetMetricsCommandSettings()                     );                      var metrics = metricsResponse.Metrics.ToDictionary(                     dict => dict.Name,                     dict => dict.Value                 );                      Assert.IsTrue(metrics["DevToolsCommandDuration"] > 0);                 Assert.AreEqual(12, metrics["Frames"]);             }                  [TestMethod]             public async Task SetCookie()             {                 var session = ((IDevTools)driver).GetDevToolsSession();                 var domains = session.GetVersionSpecificDomains<OpenQA.Selenium.DevTools.V137.DevToolsSessionDomains>();                 await domains.Network.Enable(new OpenQA.Selenium.DevTools.V137.Network.EnableCommandSettings());                      var cookieCommandSettings = new SetCookieCommandSettings                 {                     Name = "cheese",                     Value = "gouda",                     Domain = "www.selenium.dev",                     Secure = true                 };                 await domains.Network.SetCookie(cookieCommandSettings);                      driver.Url = "https://www.selenium.dev";                 OpenQA.Selenium.Cookie cheese = driver.Manage().Cookies.GetCookieNamed("cheese");                 Assert.AreEqual("gouda", cheese.Value);             }              }     }                        driver.intercept do |request, &continue|           continue.call(request) do |response|             response.body = 'Creamy, delicious cheese!' if request.url.include?('blank')           end         end

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/ruby/spec/bidi/cdp/network_spec.rb#L31-L35)

##### /examples/ruby/spec/bidi/cdp/network\_spec.rb

Copy  Close               # frozen_string_literal: true          require 'spec_helper'          RSpec.describe 'Network' do       let(:driver) { start_session }            it 'does basic authentication' do         driver.register(username: 'admin',                         password: 'admin',                         uri: /herokuapp/)              driver.get('https://the-internet.herokuapp.com/basic_auth')              expect(driver.find_element(tag_name: 'p').text).to eq('Congratulations! You must have the proper credentials.')       end            it 'records network response' do         content_type = []         driver.intercept do |request, &continue|           continue.call(request) do |response|             content_type << response.headers['content-type']           end         end              driver.get('https://www.selenium.dev/selenium/web/blank.html')         expect(content_type.first).to eq('text/html; charset=utf-8')       end            it 'transforms network response' do         driver.intercept do |request, &continue|           continue.call(request) do |response|             response.body = 'Creamy, delicious cheese!' if request.url.include?('blank')           end         end              driver.get('https://www.selenium.dev/selenium/web/blank.html')         expect(driver.find_element(tag_name: 'body').text).to eq('Creamy, delicious cheese!')       end            it 'intercepts network request' do         driver.intercept do |request, &continue|           uri = URI(request.url)           request.url = uri.to_s.gsub('one', 'two') if uri.path&.end_with?('one.js')           continue.call(request)         end              driver.get('https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html')         driver.find_element(tag_name: 'button').click         expect(driver.find_element(id: 'result').text).to eq('two')       end            it 'gets performance metrics' do         driver.get('https://www.selenium.dev/selenium/web/frameset.html')              driver.devtools.performance.enable         metric_list = driver.devtools.performance.get_metrics.dig('result', 'metrics')              metrics = metric_list.each_with_object({}) do |metric, hash|           hash[metric['name']] = metric['value']         end              expect(metrics['DevToolsCommandDuration']).to be > 0         expect(metrics['Frames']).to eq 12       end            it 'sets cookie' do         driver.devtools.network.set_cookie(name: 'cheese',                                            value: 'gouda',                                            domain: 'www.selenium.dev',                                            secure: true)              driver.get('https://www.selenium.dev')         cheese = driver.manage.cookie_named('cheese')              expect(cheese[:value]).to eq 'gouda'       end            it 'waits for downloads', except: {platform: :windows} do         driver.get('https://www.selenium.dev/selenium/web/downloads/download.html')              driver.devtools.browser.set_download_behavior(behavior: 'allow',                                                       download_path: '',                                                       events_enabled: true)              driver.devtools.browser.on(:download_progress) do |progress|           @completed = progress['state'] == 'completed'         end              driver.find_element(id: 'file-2').click              expect { Selenium::WebDriver::Wait.new.until { @completed } }.not_to raise_exception       end     end     

[Implementation Missing](https://github.com/SeleniumHQ/selenium)

[Add Example](https://www.selenium.dev/documentation/about/contributing/#creating-examples)

#### Request interception

  * Java   * Python   * CSharp   * Ruby   * JavaScript   * Kotlin

                  try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           if (req.getUri().contains("one.js")) {                             req =                                 new HttpRequest(                                     HttpMethod.GET, req.getUri().replace("one.js", "two.js"));                           }                           completed.set(true);                           return next.execute(req);                         })) {

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/java/src/test/java/dev/selenium/bidi/cdp/NetworkTest.java#L97-L110)

##### /examples/java/src/test/java/dev/selenium/bidi/cdp/NetworkTest.java

Copy  Close               package dev.selenium.bidi.cdp;          import com.google.common.net.MediaType;     import dev.selenium.BaseTest;     import java.net.*;     import java.time.Duration;     import java.util.HashMap;     import java.util.List;     import java.util.Map;     import java.util.Objects;     import java.util.Optional;     import java.util.concurrent.CopyOnWriteArrayList;     import java.util.concurrent.atomic.AtomicBoolean;     import java.util.function.Predicate;     import java.util.function.Supplier;     import org.junit.jupiter.api.Assertions;     import org.junit.jupiter.api.BeforeEach;     import org.junit.jupiter.api.Test;     import org.openqa.selenium.*;     import org.openqa.selenium.chrome.ChromeDriver;     import org.openqa.selenium.devtools.DevTools;     import org.openqa.selenium.devtools.HasDevTools;     import org.openqa.selenium.devtools.NetworkInterceptor;     import org.openqa.selenium.devtools.v137.browser.Browser;     import org.openqa.selenium.devtools.v137.network.Network;     import org.openqa.selenium.devtools.v137.performance.Performance;     import org.openqa.selenium.devtools.v137.performance.model.Metric;     import org.openqa.selenium.remote.http.*;     import org.openqa.selenium.support.ui.WebDriverWait;          public class NetworkTest extends BaseTest {            @BeforeEach       public void createSession() {         driver = new ChromeDriver();         wait = new WebDriverWait(driver, Duration.ofSeconds(10));       }            @Test       public void basicAuthentication() {         Predicate<URI> uriPredicate = uri -> uri.toString().contains("herokuapp.com");         Supplier<Credentials> authentication = UsernameAndPassword.of("admin", "admin");         ((HasAuthentication) driver).register(uriPredicate, authentication);              driver.get("https://the-internet.herokuapp.com/basic_auth");              String successMessage = "Congratulations! You must have the proper credentials.";         WebElement elementMessage = driver.findElement(By.tagName("p"));         Assertions.assertEquals(successMessage, elementMessage.getText());       }            @Test       public void recordResponse() {         CopyOnWriteArrayList<String> contentType = new CopyOnWriteArrayList<>();              try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           HttpResponse res = next.execute(req);                           contentType.add(res.getHeader("Content-Type"));                           return res;                         })) {           driver.get("https://www.selenium.dev/selenium/web/blank.html");           wait.until(_d -> contentType.size() > 1);         }              Assertions.assertEquals("text/html; charset=utf-8", contentType.get(0));       }            @Test       public void transformResponses() {         try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 Route.matching(req -> true)                     .to(                         () ->                             req ->                                 new HttpResponse()                                     .setStatus(200)                                     .addHeader("Content-Type", MediaType.HTML_UTF_8.toString())                                     .setContent(Contents.utf8String("Creamy, delicious cheese!"))))) {           driver.get("https://www.selenium.dev/selenium/web/blank.html");         }              WebElement body = driver.findElement(By.tagName("body"));         Assertions.assertEquals("Creamy, delicious cheese!", body.getText());       }            @Test       public void interceptRequests() {         AtomicBoolean completed = new AtomicBoolean(false);              try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           if (req.getUri().contains("one.js")) {                             req =                                 new HttpRequest(                                     HttpMethod.GET, req.getUri().replace("one.js", "two.js"));                           }                           completed.set(true);                           return next.execute(req);                         })) {           driver.get("https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html");           driver.findElement(By.tagName("button")).click();         }              Assertions.assertEquals("two", driver.findElement(By.id("result")).getText());       }            @Test       public void performanceMetrics() {         driver.get("https://www.selenium.dev/selenium/web/frameset.html");              DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(Performance.enable(Optional.empty()));         List<Metric> metricList = devTools.send(Performance.getMetrics());              Map<String, Number> metrics = new HashMap<>();         for (Metric metric : metricList) {           metrics.put(metric.getName(), metric.getValue());         }              Assertions.assertTrue(metrics.get("DevToolsCommandDuration").doubleValue() > 0);         Assertions.assertEquals(12, metrics.get("Frames").intValue());       }            @Test       public void setCookie() {         DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(                 Network.setCookie(                         "cheese",                         "gouda",                         Optional.empty(),                         Optional.of("www.selenium.dev"),                         Optional.empty(),                         Optional.of(true),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty()));              driver.get("https://www.selenium.dev");         Cookie cheese = driver.manage().getCookieNamed("cheese");         Assertions.assertEquals("gouda", cheese.getValue());       }            @Test       public void waitForDownload() {         driver.get("https://www.selenium.dev/selenium/web/downloads/download.html");              DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(                 Browser.setDownloadBehavior(                         Browser.SetDownloadBehaviorBehavior.ALLOWANDNAME,                         Optional.empty(),                         Optional.of(""),                         Optional.of(true)));              AtomicBoolean completed = new AtomicBoolean(false);         devTools.addListener(                 Browser.downloadProgress(),                 e -> completed.set(Objects.equals(e.getState().toString(), "completed")));              driver.findElement(By.id("file-2")).click();              Assertions.assertDoesNotThrow(() -> wait.until(_d -> completed));       }     }     

[Implementation Missing](https://github.com/SeleniumHQ/selenium)                           var handler = new NetworkRequestHandler                 {                     RequestMatcher = request => request.Url.Contains("one.js"),                     RequestTransformer = request =>                     {                         request.Url = request.Url.Replace("one", "two");                              return request;                     }                 };                 INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddRequestHandler(handler);                 await networkInterceptor.StartMonitoring();

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/dotnet/SeleniumDocs/BiDi/CDP/NetworkTest.cs#L85-L97)

##### /examples/dotnet/SeleniumDocs/BiDi/CDP/NetworkTest.cs

Copy  Close               using System.Collections.Generic;     using System.Threading.Tasks;     using Microsoft.VisualStudio.TestTools.UnitTesting;     using OpenQA.Selenium;     using OpenQA.Selenium.DevTools;     using System.Linq;     using OpenQA.Selenium.DevTools.V137.Network;     using OpenQA.Selenium.DevTools.V137.Performance;               namespace SeleniumDocs.BiDi.CDP     {         [TestClass]         public class NetworkTest : BaseTest         {             [TestInitialize]             public void Startup()             {                 StartDriver("137");             }                  [TestMethod]             public async Task BasicAuthentication()             {                 var handler = new NetworkAuthenticationHandler()                 {                     UriMatcher = uri => uri.AbsoluteUri.Contains("herokuapp"),                     Credentials = new PasswordCredentials("admin", "admin")                 };                 var networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddAuthenticationHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://the-internet.herokuapp.com/basic_auth");                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("Congratulations! You must have the proper credentials.",                     driver.FindElement(By.TagName("p")).Text);             }                  [TestMethod]             public async Task RecordNetworkResponse()             {                 var contentType = new List<string>();                      INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.NetworkResponseReceived += (_, e)  =>                 {                     contentType.Add(e.ResponseHeaders["content-type"]);                 };                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://www.selenium.dev/selenium/web/blank.html");                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("text/html; charset=utf-8", contentType[0]);             }                  [TestMethod]             public async Task TransformNetworkResponse()             {                 var handler = new NetworkResponseHandler()                 {                     ResponseMatcher = _ => true,                     ResponseTransformer = _ => new HttpResponseData                     {                         StatusCode = 200,                         Body = "Creamy, delicious cheese!"                     }                 };                 INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddResponseHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://www.selenium.dev");                 await networkInterceptor.StopMonitoring();                      var body = driver.FindElement(By.TagName("body"));                 Assert.AreEqual("Creamy, delicious cheese!", body.Text);             }                  [TestMethod]             public async Task TransformNetworkRequest()             {                 var handler = new NetworkRequestHandler                 {                     RequestMatcher = request => request.Url.Contains("one.js"),                     RequestTransformer = request =>                     {                         request.Url = request.Url.Replace("one", "two");                              return request;                     }                 };                 INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddRequestHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Url = "https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html";                 driver.FindElement(By.TagName("button")).Click();                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("two", driver.FindElement(By.Id("result")).Text);             }                  [TestMethod]             public async Task PerformanceMetrics()             {                 driver.Url = "https://www.selenium.dev/selenium/web/frameset.html";                      var session = ((IDevTools)driver).GetDevToolsSession();                 var domains = session.GetVersionSpecificDomains<OpenQA.Selenium.DevTools.V137.DevToolsSessionDomains>();                      await domains.Performance.Enable(new OpenQA.Selenium.DevTools.V137.Performance.EnableCommandSettings());                 var metricsResponse =                     await session.SendCommand<GetMetricsCommandSettings, GetMetricsCommandResponse>(                         new GetMetricsCommandSettings()                     );                      var metrics = metricsResponse.Metrics.ToDictionary(                     dict => dict.Name,                     dict => dict.Value                 );                      Assert.IsTrue(metrics["DevToolsCommandDuration"] > 0);                 Assert.AreEqual(12, metrics["Frames"]);             }                  [TestMethod]             public async Task SetCookie()             {                 var session = ((IDevTools)driver).GetDevToolsSession();                 var domains = session.GetVersionSpecificDomains<OpenQA.Selenium.DevTools.V137.DevToolsSessionDomains>();                 await domains.Network.Enable(new OpenQA.Selenium.DevTools.V137.Network.EnableCommandSettings());                      var cookieCommandSettings = new SetCookieCommandSettings                 {                     Name = "cheese",                     Value = "gouda",                     Domain = "www.selenium.dev",                     Secure = true                 };                 await domains.Network.SetCookie(cookieCommandSettings);                      driver.Url = "https://www.selenium.dev";                 OpenQA.Selenium.Cookie cheese = driver.Manage().Cookies.GetCookieNamed("cheese");                 Assert.AreEqual("gouda", cheese.Value);             }              }     }                        driver.intercept do |request, &continue|           uri = URI(request.url)           request.url = uri.to_s.gsub('one', 'two') if uri.path&.end_with?('one.js')           continue.call(request)         end

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/ruby/spec/bidi/cdp/network_spec.rb#L42-L46)

##### /examples/ruby/spec/bidi/cdp/network\_spec.rb

Copy  Close               # frozen_string_literal: true          require 'spec_helper'          RSpec.describe 'Network' do       let(:driver) { start_session }            it 'does basic authentication' do         driver.register(username: 'admin',                         password: 'admin',                         uri: /herokuapp/)              driver.get('https://the-internet.herokuapp.com/basic_auth')              expect(driver.find_element(tag_name: 'p').text).to eq('Congratulations! You must have the proper credentials.')       end            it 'records network response' do         content_type = []         driver.intercept do |request, &continue|           continue.call(request) do |response|             content_type << response.headers['content-type']           end         end              driver.get('https://www.selenium.dev/selenium/web/blank.html')         expect(content_type.first).to eq('text/html; charset=utf-8')       end            it 'transforms network response' do         driver.intercept do |request, &continue|           continue.call(request) do |response|             response.body = 'Creamy, delicious cheese!' if request.url.include?('blank')           end         end              driver.get('https://www.selenium.dev/selenium/web/blank.html')         expect(driver.find_element(tag_name: 'body').text).to eq('Creamy, delicious cheese!')       end            it 'intercepts network request' do         driver.intercept do |request, &continue|           uri = URI(request.url)           request.url = uri.to_s.gsub('one', 'two') if uri.path&.end_with?('one.js')           continue.call(request)         end              driver.get('https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html')         driver.find_element(tag_name: 'button').click         expect(driver.find_element(id: 'result').text).to eq('two')       end            it 'gets performance metrics' do         driver.get('https://www.selenium.dev/selenium/web/frameset.html')              driver.devtools.performance.enable         metric_list = driver.devtools.performance.get_metrics.dig('result', 'metrics')              metrics = metric_list.each_with_object({}) do |metric, hash|           hash[metric['name']] = metric['value']         end              expect(metrics['DevToolsCommandDuration']).to be > 0         expect(metrics['Frames']).to eq 12       end            it 'sets cookie' do         driver.devtools.network.set_cookie(name: 'cheese',                                            value: 'gouda',                                            domain: 'www.selenium.dev',                                            secure: true)              driver.get('https://www.selenium.dev')         cheese = driver.manage.cookie_named('cheese')              expect(cheese[:value]).to eq 'gouda'       end            it 'waits for downloads', except: {platform: :windows} do         driver.get('https://www.selenium.dev/selenium/web/downloads/download.html')              driver.devtools.browser.set_download_behavior(behavior: 'allow',                                                       download_path: '',                                                       events_enabled: true)              driver.devtools.browser.on(:download_progress) do |progress|           @completed = progress['state'] == 'completed'         end              driver.find_element(id: 'file-2').click              expect { Selenium::WebDriver::Wait.new.until { @completed } }.not_to raise_exception       end     end     

[Implementation Missing](https://github.com/SeleniumHQ/selenium)

[Add Example](https://www.selenium.dev/documentation/about/contributing/#creating-examples)

## Performance Metrics

  * Java   * Python   * CSharp   * Ruby   * JavaScript   * Kotlin

                  devTools.send(Performance.enable(Optional.empty()));         List<Metric> metricList = devTools.send(Performance.getMetrics());

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/java/src/test/java/dev/selenium/bidi/cdp/NetworkTest.java#L125-L126)

##### /examples/java/src/test/java/dev/selenium/bidi/cdp/NetworkTest.java

Copy  Close               package dev.selenium.bidi.cdp;          import com.google.common.net.MediaType;     import dev.selenium.BaseTest;     import java.net.*;     import java.time.Duration;     import java.util.HashMap;     import java.util.List;     import java.util.Map;     import java.util.Objects;     import java.util.Optional;     import java.util.concurrent.CopyOnWriteArrayList;     import java.util.concurrent.atomic.AtomicBoolean;     import java.util.function.Predicate;     import java.util.function.Supplier;     import org.junit.jupiter.api.Assertions;     import org.junit.jupiter.api.BeforeEach;     import org.junit.jupiter.api.Test;     import org.openqa.selenium.*;     import org.openqa.selenium.chrome.ChromeDriver;     import org.openqa.selenium.devtools.DevTools;     import org.openqa.selenium.devtools.HasDevTools;     import org.openqa.selenium.devtools.NetworkInterceptor;     import org.openqa.selenium.devtools.v137.browser.Browser;     import org.openqa.selenium.devtools.v137.network.Network;     import org.openqa.selenium.devtools.v137.performance.Performance;     import org.openqa.selenium.devtools.v137.performance.model.Metric;     import org.openqa.selenium.remote.http.*;     import org.openqa.selenium.support.ui.WebDriverWait;          public class NetworkTest extends BaseTest {            @BeforeEach       public void createSession() {         driver = new ChromeDriver();         wait = new WebDriverWait(driver, Duration.ofSeconds(10));       }            @Test       public void basicAuthentication() {         Predicate<URI> uriPredicate = uri -> uri.toString().contains("herokuapp.com");         Supplier<Credentials> authentication = UsernameAndPassword.of("admin", "admin");         ((HasAuthentication) driver).register(uriPredicate, authentication);              driver.get("https://the-internet.herokuapp.com/basic_auth");              String successMessage = "Congratulations! You must have the proper credentials.";         WebElement elementMessage = driver.findElement(By.tagName("p"));         Assertions.assertEquals(successMessage, elementMessage.getText());       }            @Test       public void recordResponse() {         CopyOnWriteArrayList<String> contentType = new CopyOnWriteArrayList<>();              try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           HttpResponse res = next.execute(req);                           contentType.add(res.getHeader("Content-Type"));                           return res;                         })) {           driver.get("https://www.selenium.dev/selenium/web/blank.html");           wait.until(_d -> contentType.size() > 1);         }              Assertions.assertEquals("text/html; charset=utf-8", contentType.get(0));       }            @Test       public void transformResponses() {         try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 Route.matching(req -> true)                     .to(                         () ->                             req ->                                 new HttpResponse()                                     .setStatus(200)                                     .addHeader("Content-Type", MediaType.HTML_UTF_8.toString())                                     .setContent(Contents.utf8String("Creamy, delicious cheese!"))))) {           driver.get("https://www.selenium.dev/selenium/web/blank.html");         }              WebElement body = driver.findElement(By.tagName("body"));         Assertions.assertEquals("Creamy, delicious cheese!", body.getText());       }            @Test       public void interceptRequests() {         AtomicBoolean completed = new AtomicBoolean(false);              try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           if (req.getUri().contains("one.js")) {                             req =                                 new HttpRequest(                                     HttpMethod.GET, req.getUri().replace("one.js", "two.js"));                           }                           completed.set(true);                           return next.execute(req);                         })) {           driver.get("https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html");           driver.findElement(By.tagName("button")).click();         }              Assertions.assertEquals("two", driver.findElement(By.id("result")).getText());       }            @Test       public void performanceMetrics() {         driver.get("https://www.selenium.dev/selenium/web/frameset.html");              DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(Performance.enable(Optional.empty()));         List<Metric> metricList = devTools.send(Performance.getMetrics());              Map<String, Number> metrics = new HashMap<>();         for (Metric metric : metricList) {           metrics.put(metric.getName(), metric.getValue());         }              Assertions.assertTrue(metrics.get("DevToolsCommandDuration").doubleValue() > 0);         Assertions.assertEquals(12, metrics.get("Frames").intValue());       }            @Test       public void setCookie() {         DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(                 Network.setCookie(                         "cheese",                         "gouda",                         Optional.empty(),                         Optional.of("www.selenium.dev"),                         Optional.empty(),                         Optional.of(true),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty()));              driver.get("https://www.selenium.dev");         Cookie cheese = driver.manage().getCookieNamed("cheese");         Assertions.assertEquals("gouda", cheese.getValue());       }            @Test       public void waitForDownload() {         driver.get("https://www.selenium.dev/selenium/web/downloads/download.html");              DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(                 Browser.setDownloadBehavior(                         Browser.SetDownloadBehaviorBehavior.ALLOWANDNAME,                         Optional.empty(),                         Optional.of(""),                         Optional.of(true)));              AtomicBoolean completed = new AtomicBoolean(false);         devTools.addListener(                 Browser.downloadProgress(),                 e -> completed.set(Objects.equals(e.getState().toString(), "completed")));              driver.findElement(By.id("file-2")).click();              Assertions.assertDoesNotThrow(() -> wait.until(_d -> completed));       }     }                        async with driver.bidi_connection() as connection:             await connection.session.execute(connection.devtools.performance.enable())             metric_list = await connection.session.execute(connection.devtools.performance.get_metrics())

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/python/tests/bidi/cdp/test_network.py#L26-L28)

##### /examples/python/tests/bidi/cdp/test\_network.py

Copy  Close               import base64          import pytest     from selenium.webdriver.common.by import By     from selenium.webdriver.common.devtools.v137.network import Headers               @pytest.mark.trio     async def test_basic_auth(driver):         async with driver.bidi_connection() as connection:             await connection.session.execute(connection.devtools.network.enable())                  credentials = base64.b64encode("admin:admin".encode()).decode()             auth = {'authorization': 'Basic ' + credentials}             await connection.session.execute(connection.devtools.network.set_extra_http_headers(Headers(auth)))                  driver.get('https://the-internet.herokuapp.com/basic_auth')              success = driver.find_element(by=By.TAG_NAME, value='p')         assert success.text == 'Congratulations! You must have the proper credentials.'          @pytest.mark.trio     async def test_performance(driver):         driver.get('https://www.selenium.dev/selenium/web/frameset.html')              async with driver.bidi_connection() as connection:             await connection.session.execute(connection.devtools.performance.enable())             metric_list = await connection.session.execute(connection.devtools.performance.get_metrics())              metrics = {metric.name: metric.value for metric in metric_list}              assert metrics["DevToolsCommandDuration"] > 0         assert metrics["Frames"] == 12          @pytest.mark.trio     async def test_set_cookie(driver):         async with driver.bidi_connection() as connection:             execution = connection.devtools.network.set_cookie(                 name="cheese",                 value="gouda",                 domain="www.selenium.dev",                 secure=True             )             await connection.session.execute(execution)              driver.get("https://www.selenium.dev")         cheese = driver.get_cookie("cheese")              assert cheese["value"] == "gouda"                                await domains.Performance.Enable(new OpenQA.Selenium.DevTools.V137.Performance.EnableCommandSettings());                 var metricsResponse =                     await session.SendCommand<GetMetricsCommandSettings, GetMetricsCommandResponse>(                         new GetMetricsCommandSettings()                     );

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/dotnet/SeleniumDocs/BiDi/CDP/NetworkTest.cs#L114-L118)

##### /examples/dotnet/SeleniumDocs/BiDi/CDP/NetworkTest.cs

Copy  Close               using System.Collections.Generic;     using System.Threading.Tasks;     using Microsoft.VisualStudio.TestTools.UnitTesting;     using OpenQA.Selenium;     using OpenQA.Selenium.DevTools;     using System.Linq;     using OpenQA.Selenium.DevTools.V137.Network;     using OpenQA.Selenium.DevTools.V137.Performance;               namespace SeleniumDocs.BiDi.CDP     {         [TestClass]         public class NetworkTest : BaseTest         {             [TestInitialize]             public void Startup()             {                 StartDriver("137");             }                  [TestMethod]             public async Task BasicAuthentication()             {                 var handler = new NetworkAuthenticationHandler()                 {                     UriMatcher = uri => uri.AbsoluteUri.Contains("herokuapp"),                     Credentials = new PasswordCredentials("admin", "admin")                 };                 var networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddAuthenticationHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://the-internet.herokuapp.com/basic_auth");                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("Congratulations! You must have the proper credentials.",                     driver.FindElement(By.TagName("p")).Text);             }                  [TestMethod]             public async Task RecordNetworkResponse()             {                 var contentType = new List<string>();                      INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.NetworkResponseReceived += (_, e)  =>                 {                     contentType.Add(e.ResponseHeaders["content-type"]);                 };                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://www.selenium.dev/selenium/web/blank.html");                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("text/html; charset=utf-8", contentType[0]);             }                  [TestMethod]             public async Task TransformNetworkResponse()             {                 var handler = new NetworkResponseHandler()                 {                     ResponseMatcher = _ => true,                     ResponseTransformer = _ => new HttpResponseData                     {                         StatusCode = 200,                         Body = "Creamy, delicious cheese!"                     }                 };                 INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddResponseHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://www.selenium.dev");                 await networkInterceptor.StopMonitoring();                      var body = driver.FindElement(By.TagName("body"));                 Assert.AreEqual("Creamy, delicious cheese!", body.Text);             }                  [TestMethod]             public async Task TransformNetworkRequest()             {                 var handler = new NetworkRequestHandler                 {                     RequestMatcher = request => request.Url.Contains("one.js"),                     RequestTransformer = request =>                     {                         request.Url = request.Url.Replace("one", "two");                              return request;                     }                 };                 INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddRequestHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Url = "https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html";                 driver.FindElement(By.TagName("button")).Click();                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("two", driver.FindElement(By.Id("result")).Text);             }                  [TestMethod]             public async Task PerformanceMetrics()             {                 driver.Url = "https://www.selenium.dev/selenium/web/frameset.html";                      var session = ((IDevTools)driver).GetDevToolsSession();                 var domains = session.GetVersionSpecificDomains<OpenQA.Selenium.DevTools.V137.DevToolsSessionDomains>();                      await domains.Performance.Enable(new OpenQA.Selenium.DevTools.V137.Performance.EnableCommandSettings());                 var metricsResponse =                     await session.SendCommand<GetMetricsCommandSettings, GetMetricsCommandResponse>(                         new GetMetricsCommandSettings()                     );                      var metrics = metricsResponse.Metrics.ToDictionary(                     dict => dict.Name,                     dict => dict.Value                 );                      Assert.IsTrue(metrics["DevToolsCommandDuration"] > 0);                 Assert.AreEqual(12, metrics["Frames"]);             }                  [TestMethod]             public async Task SetCookie()             {                 var session = ((IDevTools)driver).GetDevToolsSession();                 var domains = session.GetVersionSpecificDomains<OpenQA.Selenium.DevTools.V137.DevToolsSessionDomains>();                 await domains.Network.Enable(new OpenQA.Selenium.DevTools.V137.Network.EnableCommandSettings());                      var cookieCommandSettings = new SetCookieCommandSettings                 {                     Name = "cheese",                     Value = "gouda",                     Domain = "www.selenium.dev",                     Secure = true                 };                 await domains.Network.SetCookie(cookieCommandSettings);                      driver.Url = "https://www.selenium.dev";                 OpenQA.Selenium.Cookie cheese = driver.Manage().Cookies.GetCookieNamed("cheese");                 Assert.AreEqual("gouda", cheese.Value);             }              }     }                        driver.devtools.performance.enable         metric_list = driver.devtools.performance.get_metrics.dig('result', 'metrics')

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/ruby/spec/bidi/cdp/network_spec.rb#L56-L57)

##### /examples/ruby/spec/bidi/cdp/network\_spec.rb

Copy  Close               # frozen_string_literal: true          require 'spec_helper'          RSpec.describe 'Network' do       let(:driver) { start_session }            it 'does basic authentication' do         driver.register(username: 'admin',                         password: 'admin',                         uri: /herokuapp/)              driver.get('https://the-internet.herokuapp.com/basic_auth')              expect(driver.find_element(tag_name: 'p').text).to eq('Congratulations! You must have the proper credentials.')       end            it 'records network response' do         content_type = []         driver.intercept do |request, &continue|           continue.call(request) do |response|             content_type << response.headers['content-type']           end         end              driver.get('https://www.selenium.dev/selenium/web/blank.html')         expect(content_type.first).to eq('text/html; charset=utf-8')       end            it 'transforms network response' do         driver.intercept do |request, &continue|           continue.call(request) do |response|             response.body = 'Creamy, delicious cheese!' if request.url.include?('blank')           end         end              driver.get('https://www.selenium.dev/selenium/web/blank.html')         expect(driver.find_element(tag_name: 'body').text).to eq('Creamy, delicious cheese!')       end            it 'intercepts network request' do         driver.intercept do |request, &continue|           uri = URI(request.url)           request.url = uri.to_s.gsub('one', 'two') if uri.path&.end_with?('one.js')           continue.call(request)         end              driver.get('https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html')         driver.find_element(tag_name: 'button').click         expect(driver.find_element(id: 'result').text).to eq('two')       end            it 'gets performance metrics' do         driver.get('https://www.selenium.dev/selenium/web/frameset.html')              driver.devtools.performance.enable         metric_list = driver.devtools.performance.get_metrics.dig('result', 'metrics')              metrics = metric_list.each_with_object({}) do |metric, hash|           hash[metric['name']] = metric['value']         end              expect(metrics['DevToolsCommandDuration']).to be > 0         expect(metrics['Frames']).to eq 12       end            it 'sets cookie' do         driver.devtools.network.set_cookie(name: 'cheese',                                            value: 'gouda',                                            domain: 'www.selenium.dev',                                            secure: true)              driver.get('https://www.selenium.dev')         cheese = driver.manage.cookie_named('cheese')              expect(cheese[:value]).to eq 'gouda'       end            it 'waits for downloads', except: {platform: :windows} do         driver.get('https://www.selenium.dev/selenium/web/downloads/download.html')              driver.devtools.browser.set_download_behavior(behavior: 'allow',                                                       download_path: '',                                                       events_enabled: true)              driver.devtools.browser.on(:download_progress) do |progress|           @completed = progress['state'] == 'completed'         end              driver.find_element(id: 'file-2').click              expect { Selenium::WebDriver::Wait.new.until { @completed } }.not_to raise_exception       end     end     

[Implementation Missing](https://github.com/SeleniumHQ/selenium)

[Add Example](https://www.selenium.dev/documentation/about/contributing/#creating-examples)

## Setting Cookies

  * Java   * Python   * CSharp   * Ruby   * JavaScript   * Kotlin

                  devTools.send(                 Network.setCookie(                         "cheese",                         "gouda",                         Optional.empty(),                         Optional.of("www.selenium.dev"),                         Optional.empty(),                         Optional.of(true),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty()));

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/java/src/test/java/dev/selenium/bidi/cdp/NetworkTest.java#L142-L157)

##### /examples/java/src/test/java/dev/selenium/bidi/cdp/NetworkTest.java

Copy  Close               package dev.selenium.bidi.cdp;          import com.google.common.net.MediaType;     import dev.selenium.BaseTest;     import java.net.*;     import java.time.Duration;     import java.util.HashMap;     import java.util.List;     import java.util.Map;     import java.util.Objects;     import java.util.Optional;     import java.util.concurrent.CopyOnWriteArrayList;     import java.util.concurrent.atomic.AtomicBoolean;     import java.util.function.Predicate;     import java.util.function.Supplier;     import org.junit.jupiter.api.Assertions;     import org.junit.jupiter.api.BeforeEach;     import org.junit.jupiter.api.Test;     import org.openqa.selenium.*;     import org.openqa.selenium.chrome.ChromeDriver;     import org.openqa.selenium.devtools.DevTools;     import org.openqa.selenium.devtools.HasDevTools;     import org.openqa.selenium.devtools.NetworkInterceptor;     import org.openqa.selenium.devtools.v137.browser.Browser;     import org.openqa.selenium.devtools.v137.network.Network;     import org.openqa.selenium.devtools.v137.performance.Performance;     import org.openqa.selenium.devtools.v137.performance.model.Metric;     import org.openqa.selenium.remote.http.*;     import org.openqa.selenium.support.ui.WebDriverWait;          public class NetworkTest extends BaseTest {            @BeforeEach       public void createSession() {         driver = new ChromeDriver();         wait = new WebDriverWait(driver, Duration.ofSeconds(10));       }            @Test       public void basicAuthentication() {         Predicate<URI> uriPredicate = uri -> uri.toString().contains("herokuapp.com");         Supplier<Credentials> authentication = UsernameAndPassword.of("admin", "admin");         ((HasAuthentication) driver).register(uriPredicate, authentication);              driver.get("https://the-internet.herokuapp.com/basic_auth");              String successMessage = "Congratulations! You must have the proper credentials.";         WebElement elementMessage = driver.findElement(By.tagName("p"));         Assertions.assertEquals(successMessage, elementMessage.getText());       }            @Test       public void recordResponse() {         CopyOnWriteArrayList<String> contentType = new CopyOnWriteArrayList<>();              try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           HttpResponse res = next.execute(req);                           contentType.add(res.getHeader("Content-Type"));                           return res;                         })) {           driver.get("https://www.selenium.dev/selenium/web/blank.html");           wait.until(_d -> contentType.size() > 1);         }              Assertions.assertEquals("text/html; charset=utf-8", contentType.get(0));       }            @Test       public void transformResponses() {         try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 Route.matching(req -> true)                     .to(                         () ->                             req ->                                 new HttpResponse()                                     .setStatus(200)                                     .addHeader("Content-Type", MediaType.HTML_UTF_8.toString())                                     .setContent(Contents.utf8String("Creamy, delicious cheese!"))))) {           driver.get("https://www.selenium.dev/selenium/web/blank.html");         }              WebElement body = driver.findElement(By.tagName("body"));         Assertions.assertEquals("Creamy, delicious cheese!", body.getText());       }            @Test       public void interceptRequests() {         AtomicBoolean completed = new AtomicBoolean(false);              try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           if (req.getUri().contains("one.js")) {                             req =                                 new HttpRequest(                                     HttpMethod.GET, req.getUri().replace("one.js", "two.js"));                           }                           completed.set(true);                           return next.execute(req);                         })) {           driver.get("https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html");           driver.findElement(By.tagName("button")).click();         }              Assertions.assertEquals("two", driver.findElement(By.id("result")).getText());       }            @Test       public void performanceMetrics() {         driver.get("https://www.selenium.dev/selenium/web/frameset.html");              DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(Performance.enable(Optional.empty()));         List<Metric> metricList = devTools.send(Performance.getMetrics());              Map<String, Number> metrics = new HashMap<>();         for (Metric metric : metricList) {           metrics.put(metric.getName(), metric.getValue());         }              Assertions.assertTrue(metrics.get("DevToolsCommandDuration").doubleValue() > 0);         Assertions.assertEquals(12, metrics.get("Frames").intValue());       }            @Test       public void setCookie() {         DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(                 Network.setCookie(                         "cheese",                         "gouda",                         Optional.empty(),                         Optional.of("www.selenium.dev"),                         Optional.empty(),                         Optional.of(true),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty()));              driver.get("https://www.selenium.dev");         Cookie cheese = driver.manage().getCookieNamed("cheese");         Assertions.assertEquals("gouda", cheese.getValue());       }            @Test       public void waitForDownload() {         driver.get("https://www.selenium.dev/selenium/web/downloads/download.html");              DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(                 Browser.setDownloadBehavior(                         Browser.SetDownloadBehaviorBehavior.ALLOWANDNAME,                         Optional.empty(),                         Optional.of(""),                         Optional.of(true)));              AtomicBoolean completed = new AtomicBoolean(false);         devTools.addListener(                 Browser.downloadProgress(),                 e -> completed.set(Objects.equals(e.getState().toString(), "completed")));              driver.findElement(By.id("file-2")).click();              Assertions.assertDoesNotThrow(() -> wait.until(_d -> completed));       }     }                        async with driver.bidi_connection() as connection:             execution = connection.devtools.network.set_cookie(                 name="cheese",                 value="gouda",                 domain="www.selenium.dev",                 secure=True             )             await connection.session.execute(execution)

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/python/tests/bidi/cdp/test_network.py#L37-L44)

##### /examples/python/tests/bidi/cdp/test\_network.py

Copy  Close               import base64          import pytest     from selenium.webdriver.common.by import By     from selenium.webdriver.common.devtools.v137.network import Headers               @pytest.mark.trio     async def test_basic_auth(driver):         async with driver.bidi_connection() as connection:             await connection.session.execute(connection.devtools.network.enable())                  credentials = base64.b64encode("admin:admin".encode()).decode()             auth = {'authorization': 'Basic ' + credentials}             await connection.session.execute(connection.devtools.network.set_extra_http_headers(Headers(auth)))                  driver.get('https://the-internet.herokuapp.com/basic_auth')              success = driver.find_element(by=By.TAG_NAME, value='p')         assert success.text == 'Congratulations! You must have the proper credentials.'          @pytest.mark.trio     async def test_performance(driver):         driver.get('https://www.selenium.dev/selenium/web/frameset.html')              async with driver.bidi_connection() as connection:             await connection.session.execute(connection.devtools.performance.enable())             metric_list = await connection.session.execute(connection.devtools.performance.get_metrics())              metrics = {metric.name: metric.value for metric in metric_list}              assert metrics["DevToolsCommandDuration"] > 0         assert metrics["Frames"] == 12          @pytest.mark.trio     async def test_set_cookie(driver):         async with driver.bidi_connection() as connection:             execution = connection.devtools.network.set_cookie(                 name="cheese",                 value="gouda",                 domain="www.selenium.dev",                 secure=True             )             await connection.session.execute(execution)              driver.get("https://www.selenium.dev")         cheese = driver.get_cookie("cheese")              assert cheese["value"] == "gouda"                                var cookieCommandSettings = new SetCookieCommandSettings                 {                     Name = "cheese",                     Value = "gouda",                     Domain = "www.selenium.dev",                     Secure = true                 };                 await domains.Network.SetCookie(cookieCommandSettings);

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/dotnet/SeleniumDocs/BiDi/CDP/NetworkTest.cs#L136-L143)

##### /examples/dotnet/SeleniumDocs/BiDi/CDP/NetworkTest.cs

Copy  Close               using System.Collections.Generic;     using System.Threading.Tasks;     using Microsoft.VisualStudio.TestTools.UnitTesting;     using OpenQA.Selenium;     using OpenQA.Selenium.DevTools;     using System.Linq;     using OpenQA.Selenium.DevTools.V137.Network;     using OpenQA.Selenium.DevTools.V137.Performance;               namespace SeleniumDocs.BiDi.CDP     {         [TestClass]         public class NetworkTest : BaseTest         {             [TestInitialize]             public void Startup()             {                 StartDriver("137");             }                  [TestMethod]             public async Task BasicAuthentication()             {                 var handler = new NetworkAuthenticationHandler()                 {                     UriMatcher = uri => uri.AbsoluteUri.Contains("herokuapp"),                     Credentials = new PasswordCredentials("admin", "admin")                 };                 var networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddAuthenticationHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://the-internet.herokuapp.com/basic_auth");                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("Congratulations! You must have the proper credentials.",                     driver.FindElement(By.TagName("p")).Text);             }                  [TestMethod]             public async Task RecordNetworkResponse()             {                 var contentType = new List<string>();                      INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.NetworkResponseReceived += (_, e)  =>                 {                     contentType.Add(e.ResponseHeaders["content-type"]);                 };                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://www.selenium.dev/selenium/web/blank.html");                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("text/html; charset=utf-8", contentType[0]);             }                  [TestMethod]             public async Task TransformNetworkResponse()             {                 var handler = new NetworkResponseHandler()                 {                     ResponseMatcher = _ => true,                     ResponseTransformer = _ => new HttpResponseData                     {                         StatusCode = 200,                         Body = "Creamy, delicious cheese!"                     }                 };                 INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddResponseHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Navigate().GoToUrl("https://www.selenium.dev");                 await networkInterceptor.StopMonitoring();                      var body = driver.FindElement(By.TagName("body"));                 Assert.AreEqual("Creamy, delicious cheese!", body.Text);             }                  [TestMethod]             public async Task TransformNetworkRequest()             {                 var handler = new NetworkRequestHandler                 {                     RequestMatcher = request => request.Url.Contains("one.js"),                     RequestTransformer = request =>                     {                         request.Url = request.Url.Replace("one", "two");                              return request;                     }                 };                 INetwork networkInterceptor = driver.Manage().Network;                 networkInterceptor.AddRequestHandler(handler);                 await networkInterceptor.StartMonitoring();                      driver.Url = "https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html";                 driver.FindElement(By.TagName("button")).Click();                 await networkInterceptor.StopMonitoring();                      Assert.AreEqual("two", driver.FindElement(By.Id("result")).Text);             }                  [TestMethod]             public async Task PerformanceMetrics()             {                 driver.Url = "https://www.selenium.dev/selenium/web/frameset.html";                      var session = ((IDevTools)driver).GetDevToolsSession();                 var domains = session.GetVersionSpecificDomains<OpenQA.Selenium.DevTools.V137.DevToolsSessionDomains>();                      await domains.Performance.Enable(new OpenQA.Selenium.DevTools.V137.Performance.EnableCommandSettings());                 var metricsResponse =                     await session.SendCommand<GetMetricsCommandSettings, GetMetricsCommandResponse>(                         new GetMetricsCommandSettings()                     );                      var metrics = metricsResponse.Metrics.ToDictionary(                     dict => dict.Name,                     dict => dict.Value                 );                      Assert.IsTrue(metrics["DevToolsCommandDuration"] > 0);                 Assert.AreEqual(12, metrics["Frames"]);             }                  [TestMethod]             public async Task SetCookie()             {                 var session = ((IDevTools)driver).GetDevToolsSession();                 var domains = session.GetVersionSpecificDomains<OpenQA.Selenium.DevTools.V137.DevToolsSessionDomains>();                 await domains.Network.Enable(new OpenQA.Selenium.DevTools.V137.Network.EnableCommandSettings());                      var cookieCommandSettings = new SetCookieCommandSettings                 {                     Name = "cheese",                     Value = "gouda",                     Domain = "www.selenium.dev",                     Secure = true                 };                 await domains.Network.SetCookie(cookieCommandSettings);                      driver.Url = "https://www.selenium.dev";                 OpenQA.Selenium.Cookie cheese = driver.Manage().Cookies.GetCookieNamed("cheese");                 Assert.AreEqual("gouda", cheese.Value);             }              }     }                        driver.devtools.network.set_cookie(name: 'cheese',                                            value: 'gouda',                                            domain: 'www.selenium.dev',                                            secure: true)

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/ruby/spec/bidi/cdp/network_spec.rb#L68-L71)

##### /examples/ruby/spec/bidi/cdp/network\_spec.rb

Copy  Close               # frozen_string_literal: true          require 'spec_helper'          RSpec.describe 'Network' do       let(:driver) { start_session }            it 'does basic authentication' do         driver.register(username: 'admin',                         password: 'admin',                         uri: /herokuapp/)              driver.get('https://the-internet.herokuapp.com/basic_auth')              expect(driver.find_element(tag_name: 'p').text).to eq('Congratulations! You must have the proper credentials.')       end            it 'records network response' do         content_type = []         driver.intercept do |request, &continue|           continue.call(request) do |response|             content_type << response.headers['content-type']           end         end              driver.get('https://www.selenium.dev/selenium/web/blank.html')         expect(content_type.first).to eq('text/html; charset=utf-8')       end            it 'transforms network response' do         driver.intercept do |request, &continue|           continue.call(request) do |response|             response.body = 'Creamy, delicious cheese!' if request.url.include?('blank')           end         end              driver.get('https://www.selenium.dev/selenium/web/blank.html')         expect(driver.find_element(tag_name: 'body').text).to eq('Creamy, delicious cheese!')       end            it 'intercepts network request' do         driver.intercept do |request, &continue|           uri = URI(request.url)           request.url = uri.to_s.gsub('one', 'two') if uri.path&.end_with?('one.js')           continue.call(request)         end              driver.get('https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html')         driver.find_element(tag_name: 'button').click         expect(driver.find_element(id: 'result').text).to eq('two')       end            it 'gets performance metrics' do         driver.get('https://www.selenium.dev/selenium/web/frameset.html')              driver.devtools.performance.enable         metric_list = driver.devtools.performance.get_metrics.dig('result', 'metrics')              metrics = metric_list.each_with_object({}) do |metric, hash|           hash[metric['name']] = metric['value']         end              expect(metrics['DevToolsCommandDuration']).to be > 0         expect(metrics['Frames']).to eq 12       end            it 'sets cookie' do         driver.devtools.network.set_cookie(name: 'cheese',                                            value: 'gouda',                                            domain: 'www.selenium.dev',                                            secure: true)              driver.get('https://www.selenium.dev')         cheese = driver.manage.cookie_named('cheese')              expect(cheese[:value]).to eq 'gouda'       end            it 'waits for downloads', except: {platform: :windows} do         driver.get('https://www.selenium.dev/selenium/web/downloads/download.html')              driver.devtools.browser.set_download_behavior(behavior: 'allow',                                                       download_path: '',                                                       events_enabled: true)              driver.devtools.browser.on(:download_progress) do |progress|           @completed = progress['state'] == 'completed'         end              driver.find_element(id: 'file-2').click              expect { Selenium::WebDriver::Wait.new.until { @completed } }.not_to raise_exception       end     end     

[Implementation Missing](https://github.com/SeleniumHQ/selenium)

[Add Example](https://www.selenium.dev/documentation/about/contributing/#creating-examples)

## Waiting for Downloads

  * Java   * Python   * CSharp   * Ruby   * JavaScript   * Kotlin

                  devTools.send(                 Browser.setDownloadBehavior(                         Browser.SetDownloadBehaviorBehavior.ALLOWANDNAME,                         Optional.empty(),                         Optional.of(""),                         Optional.of(true)));

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/java/src/test/java/dev/selenium/bidi/cdp/NetworkTest.java#L171-L176)

##### /examples/java/src/test/java/dev/selenium/bidi/cdp/NetworkTest.java

Copy  Close               package dev.selenium.bidi.cdp;          import com.google.common.net.MediaType;     import dev.selenium.BaseTest;     import java.net.*;     import java.time.Duration;     import java.util.HashMap;     import java.util.List;     import java.util.Map;     import java.util.Objects;     import java.util.Optional;     import java.util.concurrent.CopyOnWriteArrayList;     import java.util.concurrent.atomic.AtomicBoolean;     import java.util.function.Predicate;     import java.util.function.Supplier;     import org.junit.jupiter.api.Assertions;     import org.junit.jupiter.api.BeforeEach;     import org.junit.jupiter.api.Test;     import org.openqa.selenium.*;     import org.openqa.selenium.chrome.ChromeDriver;     import org.openqa.selenium.devtools.DevTools;     import org.openqa.selenium.devtools.HasDevTools;     import org.openqa.selenium.devtools.NetworkInterceptor;     import org.openqa.selenium.devtools.v137.browser.Browser;     import org.openqa.selenium.devtools.v137.network.Network;     import org.openqa.selenium.devtools.v137.performance.Performance;     import org.openqa.selenium.devtools.v137.performance.model.Metric;     import org.openqa.selenium.remote.http.*;     import org.openqa.selenium.support.ui.WebDriverWait;          public class NetworkTest extends BaseTest {            @BeforeEach       public void createSession() {         driver = new ChromeDriver();         wait = new WebDriverWait(driver, Duration.ofSeconds(10));       }            @Test       public void basicAuthentication() {         Predicate<URI> uriPredicate = uri -> uri.toString().contains("herokuapp.com");         Supplier<Credentials> authentication = UsernameAndPassword.of("admin", "admin");         ((HasAuthentication) driver).register(uriPredicate, authentication);              driver.get("https://the-internet.herokuapp.com/basic_auth");              String successMessage = "Congratulations! You must have the proper credentials.";         WebElement elementMessage = driver.findElement(By.tagName("p"));         Assertions.assertEquals(successMessage, elementMessage.getText());       }            @Test       public void recordResponse() {         CopyOnWriteArrayList<String> contentType = new CopyOnWriteArrayList<>();              try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           HttpResponse res = next.execute(req);                           contentType.add(res.getHeader("Content-Type"));                           return res;                         })) {           driver.get("https://www.selenium.dev/selenium/web/blank.html");           wait.until(_d -> contentType.size() > 1);         }              Assertions.assertEquals("text/html; charset=utf-8", contentType.get(0));       }            @Test       public void transformResponses() {         try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 Route.matching(req -> true)                     .to(                         () ->                             req ->                                 new HttpResponse()                                     .setStatus(200)                                     .addHeader("Content-Type", MediaType.HTML_UTF_8.toString())                                     .setContent(Contents.utf8String("Creamy, delicious cheese!"))))) {           driver.get("https://www.selenium.dev/selenium/web/blank.html");         }              WebElement body = driver.findElement(By.tagName("body"));         Assertions.assertEquals("Creamy, delicious cheese!", body.getText());       }            @Test       public void interceptRequests() {         AtomicBoolean completed = new AtomicBoolean(false);              try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           if (req.getUri().contains("one.js")) {                             req =                                 new HttpRequest(                                     HttpMethod.GET, req.getUri().replace("one.js", "two.js"));                           }                           completed.set(true);                           return next.execute(req);                         })) {           driver.get("https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html");           driver.findElement(By.tagName("button")).click();         }              Assertions.assertEquals("two", driver.findElement(By.id("result")).getText());       }            @Test       public void performanceMetrics() {         driver.get("https://www.selenium.dev/selenium/web/frameset.html");              DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(Performance.enable(Optional.empty()));         List<Metric> metricList = devTools.send(Performance.getMetrics());              Map<String, Number> metrics = new HashMap<>();         for (Metric metric : metricList) {           metrics.put(metric.getName(), metric.getValue());         }              Assertions.assertTrue(metrics.get("DevToolsCommandDuration").doubleValue() > 0);         Assertions.assertEquals(12, metrics.get("Frames").intValue());       }            @Test       public void setCookie() {         DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(                 Network.setCookie(                         "cheese",                         "gouda",                         Optional.empty(),                         Optional.of("www.selenium.dev"),                         Optional.empty(),                         Optional.of(true),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty()));              driver.get("https://www.selenium.dev");         Cookie cheese = driver.manage().getCookieNamed("cheese");         Assertions.assertEquals("gouda", cheese.getValue());       }            @Test       public void waitForDownload() {         driver.get("https://www.selenium.dev/selenium/web/downloads/download.html");              DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(                 Browser.setDownloadBehavior(                         Browser.SetDownloadBehaviorBehavior.ALLOWANDNAME,                         Optional.empty(),                         Optional.of(""),                         Optional.of(true)));              AtomicBoolean completed = new AtomicBoolean(false);         devTools.addListener(                 Browser.downloadProgress(),                 e -> completed.set(Objects.equals(e.getState().toString(), "completed")));              driver.findElement(By.id("file-2")).click();              Assertions.assertDoesNotThrow(() -> wait.until(_d -> completed));       }     }     

[Implementation Missing](https://github.com/SeleniumHQ/selenium)

[Implementation Missing](https://github.com/SeleniumHQ/selenium)                   driver.devtools.browser.set_download_behavior(behavior: 'allow',                                                       download_path: '',                                                       events_enabled: true)              driver.devtools.browser.on(:download_progress) do |progress|           @completed = progress['state'] == 'completed'         end

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/ruby/spec/bidi/cdp/network_spec.rb#L82-L88)

##### /examples/ruby/spec/bidi/cdp/network\_spec.rb

Copy  Close               # frozen_string_literal: true          require 'spec_helper'          RSpec.describe 'Network' do       let(:driver) { start_session }            it 'does basic authentication' do         driver.register(username: 'admin',                         password: 'admin',                         uri: /herokuapp/)              driver.get('https://the-internet.herokuapp.com/basic_auth')              expect(driver.find_element(tag_name: 'p').text).to eq('Congratulations! You must have the proper credentials.')       end            it 'records network response' do         content_type = []         driver.intercept do |request, &continue|           continue.call(request) do |response|             content_type << response.headers['content-type']           end         end              driver.get('https://www.selenium.dev/selenium/web/blank.html')         expect(content_type.first).to eq('text/html; charset=utf-8')       end            it 'transforms network response' do         driver.intercept do |request, &continue|           continue.call(request) do |response|             response.body = 'Creamy, delicious cheese!' if request.url.include?('blank')           end         end              driver.get('https://www.selenium.dev/selenium/web/blank.html')         expect(driver.find_element(tag_name: 'body').text).to eq('Creamy, delicious cheese!')       end            it 'intercepts network request' do         driver.intercept do |request, &continue|           uri = URI(request.url)           request.url = uri.to_s.gsub('one', 'two') if uri.path&.end_with?('one.js')           continue.call(request)         end              driver.get('https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html')         driver.find_element(tag_name: 'button').click         expect(driver.find_element(id: 'result').text).to eq('two')       end            it 'gets performance metrics' do         driver.get('https://www.selenium.dev/selenium/web/frameset.html')              driver.devtools.performance.enable         metric_list = driver.devtools.performance.get_metrics.dig('result', 'metrics')              metrics = metric_list.each_with_object({}) do |metric, hash|           hash[metric['name']] = metric['value']         end              expect(metrics['DevToolsCommandDuration']).to be > 0         expect(metrics['Frames']).to eq 12       end            it 'sets cookie' do         driver.devtools.network.set_cookie(name: 'cheese',                                            value: 'gouda',                                            domain: 'www.selenium.dev',                                            secure: true)              driver.get('https://www.selenium.dev')         cheese = driver.manage.cookie_named('cheese')              expect(cheese[:value]).to eq 'gouda'       end            it 'waits for downloads', except: {platform: :windows} do         driver.get('https://www.selenium.dev/selenium/web/downloads/download.html')              driver.devtools.browser.set_download_behavior(behavior: 'allow',                                                       download_path: '',                                                       events_enabled: true)              driver.devtools.browser.on(:download_progress) do |progress|           @completed = progress['state'] == 'completed'         end              driver.find_element(id: 'file-2').click              expect { Selenium::WebDriver::Wait.new.until { @completed } }.not_to raise_exception       end     end     

[Implementation Missing](https://github.com/SeleniumHQ/selenium)

[Add Example](https://www.selenium.dev/documentation/about/contributing/#creating-examples)

# 3 - Chrome DevTools Script Features

Script features using CDP.

While Selenium 4 provides direct access to the Chrome DevTools Protocol, these methods will eventually be removed when WebDriver BiDi implemented.

## Script Pinning

  * Java   * Python   * CSharp   * Ruby   * JavaScript   * Kotlin

                  ScriptKey key = ((JavascriptExecutor) driver).pin("return arguments;");         List<Object> arguments =             (List<Object>) ((JavascriptExecutor) driver).executeScript(key, 1, true, element);

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/java/src/test/java/dev/selenium/bidi/cdp/ScriptTest.java#L32-L34)

##### /examples/java/src/test/java/dev/selenium/bidi/cdp/ScriptTest.java

Copy  Close               package dev.selenium.bidi.cdp;          import static org.openqa.selenium.devtools.events.CdpEventTypes.domMutation;          import dev.selenium.BaseTest;          import java.time.Duration;     import java.util.List;     import java.util.concurrent.CopyOnWriteArrayList;          import org.junit.jupiter.api.Assertions;     import org.junit.jupiter.api.BeforeEach;     import org.junit.jupiter.api.Test;     import org.openqa.selenium.*;     import org.openqa.selenium.chrome.ChromeDriver;     import org.openqa.selenium.logging.HasLogEvents;     import org.openqa.selenium.support.ui.WebDriverWait;          public class ScriptTest extends BaseTest {            @BeforeEach       public void createSession() {         driver = new ChromeDriver();         wait = new WebDriverWait(driver, Duration.ofSeconds(10));       }            @Test       public void pinScript() {         driver.get("https://www.selenium.dev/selenium/web/xhtmlTest.html");         WebElement element = driver.findElement(By.id("id1"));              ScriptKey key = ((JavascriptExecutor) driver).pin("return arguments;");         List<Object> arguments =             (List<Object>) ((JavascriptExecutor) driver).executeScript(key, 1, true, element);              Assertions.assertEquals(List.of(1L, true, element), arguments);       }            @Test       public void mutatedElements() {         driver.get("https://www.selenium.dev/selenium/web/dynamic.html");         CopyOnWriteArrayList<WebElement> mutations = new CopyOnWriteArrayList<>();              ((HasLogEvents) driver).onLogEvent(domMutation(e -> mutations.add(e.getElement())));              driver.findElement(By.id("reveal")).click();              wait.until(_d -> !mutations.isEmpty());         Assertions.assertEquals(mutations.get(0), driver.findElement(By.id("revealed")));       }     }     

[Implementation Missing](https://github.com/SeleniumHQ/selenium)                           var key = await new JavaScriptEngine(driver).PinScript("return arguments;");                 var arguments = ((WebDriver)driver).ExecuteScript(key, 1, true, element);

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/dotnet/SeleniumDocs/BiDi/CDP/ScriptTest.cs#L21-L22)

##### /examples/dotnet/SeleniumDocs/BiDi/CDP/ScriptTest.cs

Copy  Close               using System;     using System.Collections;     using System.Collections.Generic;     using System.Threading.Tasks;     using Microsoft.IdentityModel.Tokens;     using Microsoft.VisualStudio.TestTools.UnitTesting;     using OpenQA.Selenium;     using OpenQA.Selenium.Support.UI;          namespace SeleniumDocs.BiDi.CDP     {         [TestClass]         public class ScriptTest : BaseChromeTest         {             [TestMethod]             public async Task PinScript()             {                 driver.Url = "https://www.selenium.dev/selenium/web/xhtmlTest.html";                 var element = driver.FindElement(By.Id("id1"));                      var key = await new JavaScriptEngine(driver).PinScript("return arguments;");                 var arguments = ((WebDriver)driver).ExecuteScript(key, 1, true, element);                      var expected = new List<object>                 {                     1L,                     true,                     element                 };                 CollectionAssert.AreEqual(expected, (ICollection)arguments);             }                  [TestMethod]             public async Task MutatedElements()             {                 driver.Url = "https://www.selenium.dev/selenium/web/dynamic.html";                 var mutations = new List<IWebElement>();                      using IJavaScriptEngine monitor = new JavaScriptEngine(driver);                 monitor.DomMutated += (_, e) =>                 {                     var locator = By.CssSelector($"*[data-__webdriver_id='{e.AttributeData.TargetId}']");                     mutations.Add(driver.FindElement(locator));                 };                 await monitor.StartEventMonitoring();                 await monitor.EnableDomMutationMonitoring();                      driver.FindElement(By.Id("reveal")).Click();                                  new WebDriverWait(driver, TimeSpan.FromSeconds(5)).Until(_ => !mutations.IsNullOrEmpty());                 await monitor.DisableDomMutationMonitoring();                 monitor.StopEventMonitoring();                      var revealed = driver.FindElement(By.Id("revealed"));                  Assert.AreEqual(revealed, mutations[0]);             }         }     }                   key = driver.pin_script('return arguments;')         arguments = driver.execute_script(key, 1, true, element)

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/ruby/spec/bidi/cdp/script_spec.rb#L12-L13)

##### /examples/ruby/spec/bidi/cdp/script\_spec.rb

Copy  Close               # frozen_string_literal: true          require 'spec_helper'          RSpec.describe 'Script' do       let(:driver) { start_session }            it 'pins script' do         driver.get('https://www.selenium.dev/selenium/web/xhtmlTest.html')         element = driver.find_element(id: 'id1')              key = driver.pin_script('return arguments;')         arguments = driver.execute_script(key, 1, true, element)              expect(arguments).to eq([1, true, element])       end            it 'gets mutated elements' do         driver.get 'https://www.selenium.dev/selenium/web/dynamic.html'              mutations = []         driver.on_log_event(:mutation) { |mutation| mutations << mutation.element }              driver.find_element(id: 'reveal').click         Selenium::WebDriver::Wait.new(timeout: 30).until { mutations.any? }              expect(mutations).to include(driver.find_element(id: 'revealed'))       end     end     

[Implementation Missing](https://github.com/SeleniumHQ/selenium)

[Add Example](https://www.selenium.dev/documentation/about/contributing/#creating-examples)

## DOM Mutation Handlers

  * Java   * Python   * CSharp   * Ruby   * JavaScript   * Kotlin

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/java/src/test/java/dev/selenium/bidi/cdp/NetworkTest.java#L44)

##### /examples/java/src/test/java/dev/selenium/bidi/cdp/NetworkTest.java

Copy  Close               package dev.selenium.bidi.cdp;          import com.google.common.net.MediaType;     import dev.selenium.BaseTest;     import java.net.*;     import java.time.Duration;     import java.util.HashMap;     import java.util.List;     import java.util.Map;     import java.util.Objects;     import java.util.Optional;     import java.util.concurrent.CopyOnWriteArrayList;     import java.util.concurrent.atomic.AtomicBoolean;     import java.util.function.Predicate;     import java.util.function.Supplier;     import org.junit.jupiter.api.Assertions;     import org.junit.jupiter.api.BeforeEach;     import org.junit.jupiter.api.Test;     import org.openqa.selenium.*;     import org.openqa.selenium.chrome.ChromeDriver;     import org.openqa.selenium.devtools.DevTools;     import org.openqa.selenium.devtools.HasDevTools;     import org.openqa.selenium.devtools.NetworkInterceptor;     import org.openqa.selenium.devtools.v137.browser.Browser;     import org.openqa.selenium.devtools.v137.network.Network;     import org.openqa.selenium.devtools.v137.performance.Performance;     import org.openqa.selenium.devtools.v137.performance.model.Metric;     import org.openqa.selenium.remote.http.*;     import org.openqa.selenium.support.ui.WebDriverWait;          public class NetworkTest extends BaseTest {            @BeforeEach       public void createSession() {         driver = new ChromeDriver();         wait = new WebDriverWait(driver, Duration.ofSeconds(10));       }            @Test       public void basicAuthentication() {         Predicate<URI> uriPredicate = uri -> uri.toString().contains("herokuapp.com");         Supplier<Credentials> authentication = UsernameAndPassword.of("admin", "admin");         ((HasAuthentication) driver).register(uriPredicate, authentication);              driver.get("https://the-internet.herokuapp.com/basic_auth");              String successMessage = "Congratulations! You must have the proper credentials.";         WebElement elementMessage = driver.findElement(By.tagName("p"));         Assertions.assertEquals(successMessage, elementMessage.getText());       }            @Test       public void recordResponse() {         CopyOnWriteArrayList<String> contentType = new CopyOnWriteArrayList<>();              try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           HttpResponse res = next.execute(req);                           contentType.add(res.getHeader("Content-Type"));                           return res;                         })) {           driver.get("https://www.selenium.dev/selenium/web/blank.html");           wait.until(_d -> contentType.size() > 1);         }              Assertions.assertEquals("text/html; charset=utf-8", contentType.get(0));       }            @Test       public void transformResponses() {         try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 Route.matching(req -> true)                     .to(                         () ->                             req ->                                 new HttpResponse()                                     .setStatus(200)                                     .addHeader("Content-Type", MediaType.HTML_UTF_8.toString())                                     .setContent(Contents.utf8String("Creamy, delicious cheese!"))))) {           driver.get("https://www.selenium.dev/selenium/web/blank.html");         }              WebElement body = driver.findElement(By.tagName("body"));         Assertions.assertEquals("Creamy, delicious cheese!", body.getText());       }            @Test       public void interceptRequests() {         AtomicBoolean completed = new AtomicBoolean(false);              try (NetworkInterceptor ignored =             new NetworkInterceptor(                 driver,                 (Filter)                     next ->                         req -> {                           if (req.getUri().contains("one.js")) {                             req =                                 new HttpRequest(                                     HttpMethod.GET, req.getUri().replace("one.js", "two.js"));                           }                           completed.set(true);                           return next.execute(req);                         })) {           driver.get("https://www.selenium.dev/selenium/web/devToolsRequestInterceptionTest.html");           driver.findElement(By.tagName("button")).click();         }              Assertions.assertEquals("two", driver.findElement(By.id("result")).getText());       }            @Test       public void performanceMetrics() {         driver.get("https://www.selenium.dev/selenium/web/frameset.html");              DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(Performance.enable(Optional.empty()));         List<Metric> metricList = devTools.send(Performance.getMetrics());              Map<String, Number> metrics = new HashMap<>();         for (Metric metric : metricList) {           metrics.put(metric.getName(), metric.getValue());         }              Assertions.assertTrue(metrics.get("DevToolsCommandDuration").doubleValue() > 0);         Assertions.assertEquals(12, metrics.get("Frames").intValue());       }            @Test       public void setCookie() {         DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(                 Network.setCookie(                         "cheese",                         "gouda",                         Optional.empty(),                         Optional.of("www.selenium.dev"),                         Optional.empty(),                         Optional.of(true),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty(),                         Optional.empty()));              driver.get("https://www.selenium.dev");         Cookie cheese = driver.manage().getCookieNamed("cheese");         Assertions.assertEquals("gouda", cheese.getValue());       }            @Test       public void waitForDownload() {         driver.get("https://www.selenium.dev/selenium/web/downloads/download.html");              DevTools devTools = ((HasDevTools) driver).getDevTools();         devTools.createSession();              devTools.send(                 Browser.setDownloadBehavior(                         Browser.SetDownloadBehaviorBehavior.ALLOWANDNAME,                         Optional.empty(),                         Optional.of(""),                         Optional.of(true)));              AtomicBoolean completed = new AtomicBoolean(false);         devTools.addListener(                 Browser.downloadProgress(),                 e -> completed.set(Objects.equals(e.getState().toString(), "completed")));              driver.findElement(By.id("file-2")).click();              Assertions.assertDoesNotThrow(() -> wait.until(_d -> completed));       }     }                        async with driver.bidi_connection() as session:             async with Log(driver, session).mutation_events() as event:

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/python/tests/bidi/cdp/test_script.py#L10-L11)

##### /examples/python/tests/bidi/cdp/test\_script.py

Copy  Close               import pytest     import trio     from selenium.webdriver.common.by import By     from selenium.webdriver.common.log import Log     from selenium.webdriver.support.ui import WebDriverWait     from selenium.webdriver.support import expected_conditions as EC          @pytest.mark.trio     async def test_mutation(driver):         async with driver.bidi_connection() as session:             async with Log(driver, session).mutation_events() as event:                 await trio.to_thread.run_sync(lambda: driver.get('https://www.selenium.dev/selenium/web/dynamic.html'))                 await trio.to_thread.run_sync(lambda: WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.ID, "reveal"))))                 await trio.to_thread.run_sync(lambda: driver.find_element(By.ID, "reveal").click())              assert event["element"] == driver.find_element(By.ID, "revealed")                                using IJavaScriptEngine monitor = new JavaScriptEngine(driver);                 monitor.DomMutated += (_, e) =>                 {                     var locator = By.CssSelector($"*[data-__webdriver_id='{e.AttributeData.TargetId}']");                     mutations.Add(driver.FindElement(locator));                 };                 await monitor.StartEventMonitoring();                 await monitor.EnableDomMutationMonitoring();

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/dotnet/SeleniumDocs/BiDi/CDP/ScriptTest.cs#L39-L46)

##### /examples/dotnet/SeleniumDocs/BiDi/CDP/ScriptTest.cs

Copy  Close               using System;     using System.Collections;     using System.Collections.Generic;     using System.Threading.Tasks;     using Microsoft.IdentityModel.Tokens;     using Microsoft.VisualStudio.TestTools.UnitTesting;     using OpenQA.Selenium;     using OpenQA.Selenium.Support.UI;          namespace SeleniumDocs.BiDi.CDP     {         [TestClass]         public class ScriptTest : BaseChromeTest         {             [TestMethod]             public async Task PinScript()             {                 driver.Url = "https://www.selenium.dev/selenium/web/xhtmlTest.html";                 var element = driver.FindElement(By.Id("id1"));                      var key = await new JavaScriptEngine(driver).PinScript("return arguments;");                 var arguments = ((WebDriver)driver).ExecuteScript(key, 1, true, element);                      var expected = new List<object>                 {                     1L,                     true,                     element                 };                 CollectionAssert.AreEqual(expected, (ICollection)arguments);             }                  [TestMethod]             public async Task MutatedElements()             {                 driver.Url = "https://www.selenium.dev/selenium/web/dynamic.html";                 var mutations = new List<IWebElement>();                      using IJavaScriptEngine monitor = new JavaScriptEngine(driver);                 monitor.DomMutated += (_, e) =>                 {                     var locator = By.CssSelector($"*[data-__webdriver_id='{e.AttributeData.TargetId}']");                     mutations.Add(driver.FindElement(locator));                 };                 await monitor.StartEventMonitoring();                 await monitor.EnableDomMutationMonitoring();                      driver.FindElement(By.Id("reveal")).Click();                                  new WebDriverWait(driver, TimeSpan.FromSeconds(5)).Until(_ => !mutations.IsNullOrEmpty());                 await monitor.DisableDomMutationMonitoring();                 monitor.StopEventMonitoring();                      var revealed = driver.FindElement(By.Id("revealed"));                  Assert.AreEqual(revealed, mutations[0]);             }         }     }                   driver.on_log_event(:mutation) { |mutation| mutations << mutation.element }

View Complete Code [__View on GitHub](https://github.com/SeleniumHQ/seleniumhq.github.io/blob/trunk//examples/ruby/spec/bidi/cdp/script_spec.rb#L22)

##### /examples/ruby/spec/bidi/cdp/script\_spec.rb

Copy  Close               # frozen_string_literal: true          require 'spec_helper'          RSpec.describe 'Script' do       let(:driver) { start_session }            it 'pins script' do         driver.get('https://www.selenium.dev/selenium/web/xhtmlTest.html')         element = driver.find_element(id: 'id1')              key = driver.pin_script('return arguments;')         arguments = driver.execute_script(key, 1, true, element)              expect(arguments).to eq([1, true, element])       end            it 'gets mutated elements' do         driver.get 'https://www.selenium.dev/selenium/web/dynamic.html'              mutations = []         driver.on_log_event(:mutation) { |mutation| mutations << mutation.element }              driver.find_element(id: 'reveal').click         Selenium::WebDriver::Wait.new(timeout: 30).until { mutations.any? }              expect(mutations).to include(driver.find_element(id: 'revealed'))       end     end     

[Implementation Missing](https://github.com/SeleniumHQ/selenium)

[Add Example](https://www.selenium.dev/documentation/about/contributing/#creating-examples)