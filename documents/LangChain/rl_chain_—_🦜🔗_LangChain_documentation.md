# rl_chain â€” ðŸ¦œðŸ”— LangChain  documentation

**URL:** https://python.langchain.com/api_reference/experimental/rl_chain.html
**Word Count:** 275
**Links Count:** 151
**Scraped:** 2025-07-21 08:24:51
**Status:** completed

---

# `rl_chain`\#

**RL \(Reinforcement Learning\) Chain** leverages the Vowpal Wabbit \(VW\) models for reinforcement learning with a context, with the goal of modifying the prompt before the LLM call.

\[Vowpal Wabbit\]\(<https://vowpalwabbit.org/>\) provides fast, efficient, and flexible online machine learning techniques for reinforcement learning, supervised learning, and more.

**Classes**

[`rl_chain.base.AutoSelectionScorer`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.base.AutoSelectionScorer.html#langchain_experimental.rl_chain.base.AutoSelectionScorer "langchain_experimental.rl_chain.base.AutoSelectionScorer") | Auto selection scorer.   ---|---   [`rl_chain.base.Embedder`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.base.Embedder.html#langchain_experimental.rl_chain.base.Embedder "langchain_experimental.rl_chain.base.Embedder")\(\*args, \*\*kwargs\) | Abstract class to represent an embedder.   [`rl_chain.base.Event`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.base.Event.html#langchain_experimental.rl_chain.base.Event "langchain_experimental.rl_chain.base.Event")\(inputs\[, selected\]\) | Abstract class to represent an event.   [`rl_chain.base.Policy`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.base.Policy.html#langchain_experimental.rl_chain.base.Policy "langchain_experimental.rl_chain.base.Policy")\(\*\*kwargs\) | Abstract class to represent a policy.   [`rl_chain.base.RLChain`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.base.RLChain.html#langchain_experimental.rl_chain.base.RLChain "langchain_experimental.rl_chain.base.RLChain") | Chain that leverages the Vowpal Wabbit \(VW\) model as a learned policy for reinforcement learning.   `rl_chain.base.RLChain[PickBestEvent]` | Chain that leverages the Vowpal Wabbit \(VW\) model as a learned policy for reinforcement learning.   [`rl_chain.base.Selected`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.base.Selected.html#langchain_experimental.rl_chain.base.Selected "langchain_experimental.rl_chain.base.Selected")\(\) | Abstract class to represent the selected item.   [`rl_chain.base.SelectionScorer`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.base.SelectionScorer.html#langchain_experimental.rl_chain.base.SelectionScorer "langchain_experimental.rl_chain.base.SelectionScorer") | Abstract class to grade the chosen selection or the response of the llm.   [`rl_chain.base.VwPolicy`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.base.VwPolicy.html#langchain_experimental.rl_chain.base.VwPolicy "langchain_experimental.rl_chain.base.VwPolicy")\(model\_repo, vw\_cmd, ...\) | Vowpal Wabbit policy.   [`rl_chain.metrics.MetricsTrackerAverage`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.metrics.MetricsTrackerAverage.html#langchain_experimental.rl_chain.metrics.MetricsTrackerAverage "langchain_experimental.rl_chain.metrics.MetricsTrackerAverage")\(step\) | Metrics Tracker Average.   [`rl_chain.metrics.MetricsTrackerRollingWindow`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.metrics.MetricsTrackerRollingWindow.html#langchain_experimental.rl_chain.metrics.MetricsTrackerRollingWindow "langchain_experimental.rl_chain.metrics.MetricsTrackerRollingWindow")\(...\) | Metrics Tracker Rolling Window.   [`rl_chain.model_repository.ModelRepository`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.model_repository.ModelRepository.html#langchain_experimental.rl_chain.model_repository.ModelRepository "langchain_experimental.rl_chain.model_repository.ModelRepository")\(folder\) | Model Repository.   [`rl_chain.pick_best_chain.PickBest`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.pick_best_chain.PickBest.html#langchain_experimental.rl_chain.pick_best_chain.PickBest "langchain_experimental.rl_chain.pick_best_chain.PickBest") | Chain that leverages the Vowpal Wabbit \(VW\) model for reinforcement learning with a context, with the goal of modifying the prompt before the LLM call.   [`rl_chain.pick_best_chain.PickBestEvent`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.pick_best_chain.PickBestEvent.html#langchain_experimental.rl_chain.pick_best_chain.PickBestEvent "langchain_experimental.rl_chain.pick_best_chain.PickBestEvent")\(...\) | Event class for PickBest chain.   [`rl_chain.pick_best_chain.PickBestFeatureEmbedder`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.pick_best_chain.PickBestFeatureEmbedder.html#langchain_experimental.rl_chain.pick_best_chain.PickBestFeatureEmbedder "langchain_experimental.rl_chain.pick_best_chain.PickBestFeatureEmbedder")\(...\) | Embed the BasedOn and ToSelectFrom inputs into a format that can be used by the learning policy.   [`rl_chain.pick_best_chain.PickBestRandomPolicy`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.pick_best_chain.PickBestRandomPolicy.html#langchain_experimental.rl_chain.pick_best_chain.PickBestRandomPolicy "langchain_experimental.rl_chain.pick_best_chain.PickBestRandomPolicy")\(...\) | Random policy for PickBest chain.   [`rl_chain.pick_best_chain.PickBestSelected`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.pick_best_chain.PickBestSelected.html#langchain_experimental.rl_chain.pick_best_chain.PickBestSelected "langchain_experimental.rl_chain.pick_best_chain.PickBestSelected")\(\[...\]\) | Selected class for PickBest chain.   [`rl_chain.vw_logger.VwLogger`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.vw_logger.VwLogger.html#langchain_experimental.rl_chain.vw_logger.VwLogger "langchain_experimental.rl_chain.vw_logger.VwLogger")\(path\) | Vowpal Wabbit custom logger.      **Functions**

[`rl_chain.base.BasedOn`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.base.BasedOn.html#langchain_experimental.rl_chain.base.BasedOn "langchain_experimental.rl_chain.base.BasedOn")\(anything\) | Wrap a value to indicate that it should be based on.   ---|---   [`rl_chain.base.Embed`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.base.Embed.html#langchain_experimental.rl_chain.base.Embed "langchain_experimental.rl_chain.base.Embed")\(anything\[, keep\]\) | Wrap a value to indicate that it should be embedded.   [`rl_chain.base.EmbedAndKeep`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.base.EmbedAndKeep.html#langchain_experimental.rl_chain.base.EmbedAndKeep "langchain_experimental.rl_chain.base.EmbedAndKeep")\(anything\) | Wrap a value to indicate that it should be embedded and kept.   [`rl_chain.base.ToSelectFrom`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.base.ToSelectFrom.html#langchain_experimental.rl_chain.base.ToSelectFrom "langchain_experimental.rl_chain.base.ToSelectFrom")\(anything\) | Wrap a value to indicate that it should be selected from.   [`rl_chain.base.get_based_on_and_to_select_from`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.base.get_based_on_and_to_select_from.html#langchain_experimental.rl_chain.base.get_based_on_and_to_select_from "langchain_experimental.rl_chain.base.get_based_on_and_to_select_from")\(inputs\) | Get the BasedOn and ToSelectFrom from the inputs.   [`rl_chain.base.parse_lines`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.base.parse_lines.html#langchain_experimental.rl_chain.base.parse_lines "langchain_experimental.rl_chain.base.parse_lines")\(parser, input\_str\) | Parse the input string into a list of examples.   [`rl_chain.base.prepare_inputs_for_autoembed`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.base.prepare_inputs_for_autoembed.html#langchain_experimental.rl_chain.base.prepare_inputs_for_autoembed "langchain_experimental.rl_chain.base.prepare_inputs_for_autoembed")\(inputs\) | Prepare the inputs for auto embedding.   [`rl_chain.helpers.embed`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.helpers.embed.html#langchain_experimental.rl_chain.helpers.embed "langchain_experimental.rl_chain.helpers.embed")\(to\_embed, model\[, ...\]\) | Embed the actions or context using the SentenceTransformer model \(or a model that has an encode function\).   [`rl_chain.helpers.embed_dict_type`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.helpers.embed_dict_type.html#langchain_experimental.rl_chain.helpers.embed_dict_type "langchain_experimental.rl_chain.helpers.embed_dict_type")\(item, model\) | Embed a dictionary item.   [`rl_chain.helpers.embed_list_type`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.helpers.embed_list_type.html#langchain_experimental.rl_chain.helpers.embed_list_type "langchain_experimental.rl_chain.helpers.embed_list_type")\(item, model\) | Embed a list item.   [`rl_chain.helpers.embed_string_type`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.helpers.embed_string_type.html#langchain_experimental.rl_chain.helpers.embed_string_type "langchain_experimental.rl_chain.helpers.embed_string_type")\(item, model\) | Embed a string or an \_Embed object.   [`rl_chain.helpers.is_stringtype_instance`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.helpers.is_stringtype_instance.html#langchain_experimental.rl_chain.helpers.is_stringtype_instance "langchain_experimental.rl_chain.helpers.is_stringtype_instance")\(item\) | Check if an item is a string.   [`rl_chain.helpers.stringify_embedding`](https://python.langchain.com/api_reference/experimental/rl_chain/langchain_experimental.rl_chain.helpers.stringify_embedding.html#langchain_experimental.rl_chain.helpers.stringify_embedding "langchain_experimental.rl_chain.helpers.stringify_embedding")\(embedding\) | Convert an embedding to a string.